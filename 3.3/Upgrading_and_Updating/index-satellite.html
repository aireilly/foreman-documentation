<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.20">
<title>Upgrading and Updating Red&#160;Hat Satellite</title>
<style>
﻿*,::before,::after{box-sizing:border-box}html{font-size:100%;-webkit-text-size-adjust:100%}body{background:#fff;color:rgba(0,0,0,0.8);padding:0;margin:0;font-family:"Noto Serif", "DejaVu Serif", serif;font-size:inherit;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}dl,dt,dd,ul,ol,li,h1,h2,h3,h4,h5,h6,pre,p,blockquote,th,td{margin:0;padding:0}a{background:none;color:#2156a5;text-decoration:underline;line-height:inherit}a:active,a:hover{cursor:pointer;outline:0}a:focus{outline:thin dotted}a:hover,a:focus{color:#1d4b8f}abbr{font-size:0.9em}abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}b,strong{font-weight:bold;line-height:inherit}strong strong{font-weight:400}code,kbd,pre{font-family:"Droid Sans Mono", "DejaVu Sans Mono", monospace;font-size:1em}code{font-weight:400;color:rgba(0,0,0,0.9)}pre{color:rgba(0,0,0,0.9);line-height:1.45;text-rendering:optimizeSpeed;white-space:pre-wrap}dfn{font-style:italic}em,i{font-style:italic;line-height:inherit}em em{font-style:normal}hr{border:solid #dddddf;border-width:1px 0 0;clear:both;height:0;margin:1.25em 0 1.1875em}mark{background:#ff0;color:#000}p{line-height:1.6;margin-bottom:1.25rem;text-rendering:optimizeLegibility}q{quotes:"“" "”" "‘" "’"}small{font-size:60%;line-height:inherit}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sup{top:-0.5em}sub{bottom:-0.25em}img,object[type^="image/"],svg{display:inline-block;height:auto;max-width:100%;vertical-align:middle}img{border:0;-ms-interpolation-mode:bicubic}object{max-width:100%}svg:not(:root){overflow:hidden}figure{margin:0}audio,video{display:inline-block}audio:not([controls]){display:none;height:0}.left{float:left !important}.right{float:right !important}.text-left{text-align:left !important}.text-right{text-align:right !important}.text-center{text-align:center !important}.text-justify{text-align:justify !important}.hide{display:none}.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:0.25em}p aside{font-size:.875em;line-height:1.35;font-style:italic}h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans", "DejaVu Sans", sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.2;word-spacing:-0.05em}h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{color:#e99b8f;line-height:0}h1{font-size:2.125em}h2{font-size:1.6875em}h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}h4,h5{font-size:1.125em}h6{font-size:1em}ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}ul,ol{margin-left:1.5em}ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}ul.square{list-style-type:square}ul.circle{list-style-type:circle}ul.disc{list-style-type:disc}ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}dl dt{margin-bottom:.3125em;font-weight:bold}dl dd{margin-bottom:1.25em;margin-left:1.125em}blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,0.85)}@media screen and (min-width: 768px){h1{font-size:2.75em}h2{font-size:2.3125em}h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}h4{font-size:1.4375em}}table{background:#fff;border:1px solid #dedede;border-collapse:collapse;border-spacing:0;margin-bottom:1.25em;word-wrap:normal}table thead,table tfoot{background:#f7f8f7}table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,0.8);text-align:left}table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,0.8)}table tr.even,table tr.alt{background:#f8f8f7}table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}.center{margin-left:auto;margin-right:auto}.stretch{width:100%}.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:"";display:table}.clearfix::after,.float-group::after{clear:both}:not(pre).nobreak{word-wrap:normal}:not(pre).nowrap{white-space:nowrap}:not(pre).pre-wrap{white-space:pre-wrap}:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal !important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}pre>code{display:block}pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}.keyseq{color:rgba(51,51,51,0.8)}kbd{display:inline-block;color:rgba(0,0,0,0.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,0.2),inset 0 0 0 0.1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}.keyseq kbd:first-child{margin-left:0}.keyseq kbd:last-child{margin-right:0}.menuseq,.menuref{color:#000}.menuseq b:not(.caret),.menuref{font-weight:inherit}.menuseq{word-spacing:-0.02em}.menuseq b.caret{font-size:1.25em;line-height:0.8}.menuseq i.caret{font-weight:bold;text-align:center;width:0.45em}b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}b.button::before{content:"[";padding:0 3px 0 2px}b.button::after{content:"]";padding:0 2px 0 3px}p a>code:hover{color:rgba(0,0,0,0.9)}body>div[id]{margin:0 auto;max-width:62.5em;position:relative;padding-left:.9375em;padding-right:0.9375em}body>div[id]::before,body>div[id]::after,#content #footnotes::before{content:"";display:table;clear:both}#content{margin-top:1.25em;margin-bottom:0.625em}#content::before{content:none}#header>h1:first-child{color:rgba(0,0,0,0.85);margin-top:2.25rem;margin-bottom:0}#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,0.6);display:flex;flex-flow:row wrap}#header .details span:first-child{margin-left:-0.125em}#header .details span.email a{color:rgba(0,0,0,0.85)}#header .details br{display:none}#header .details br+span::before{content:" – "}#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,0.85)}#header .details br+span#revremark::before{content:" | "}#header #revnumber{text-transform:capitalize}#header #revnumber::after{content:" "}#content>h1:first-child:not([class]){color:rgba(0,0,0,0.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}#toc{border-bottom:1px solid #e7e7e9;padding-bottom:0.5em}#toc>ul{margin-left:0.125em}#toc ul.sectlevel0>li>a{font-style:italic}#toc ul.sectlevel0 ul.sectlevel1{margin:0.5em 0}#toc ul{font-family:"Open Sans", "DejaVu Sans", sans-serif;list-style-type:none}#toc li{line-height:1.3334;margin-top:0.3334em}#toc a{text-decoration:none}#toc a:active{text-decoration:underline}#toctitle{color:#7a2518;font-size:1.2em}@media screen and (min-width: 768px){#toctitle{font-size:1.375em}body.toc2{padding-left:15em;padding-right:0}#toc.toc2{margin-top:0 !important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0 !important;border-bottom-width:0 !important;z-index:1000;padding:1.25em 1em;height:calc(100% - (70px + 2.5em));overflow:auto}#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}#toc.toc2>ul{font-size:.9em;margin-bottom:0}#toc.toc2 ul ul{margin-left:0;padding-left:1em}#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:0.5em}body.toc2.toc-right{padding-left:0;padding-right:15em}body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}@media screen and (min-width: 1280px){body.toc2{padding-left:20em;padding-right:0}#toc.toc2{width:20em}#toc.toc2 #toctitle{font-size:1.375em}#toc.toc2>ul{font-size:0.95em}#toc.toc2 ul ul{padding-left:1.25em}body.toc2.toc-right{padding-left:0;padding-right:20em}}#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}#content #toc>:first-child{margin-top:0}#content #toc>:last-child{margin-bottom:0}#footer{max-width:none;background:#025d8c;padding:1.25em;margin-left:2em}#footer-text{color:rgba(255,255,255,0.8);line-height:1.44}.sect1{padding-bottom:0.625em}@media screen and (min-width: 768px){#content{margin-bottom:1.25em}.sect1{padding-bottom:1.25em}}.sect1:last-child{padding-bottom:0}.sect1+.sect1{border-top:1px solid #e7e7e9}#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none !important;visibility:hidden;text-align:center;font-weight:400}#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:0.1em}#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}details{margin-left:1.25rem}details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}details>summary::-webkit-details-marker{display:none}details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif", "DejaVu Serif", serif;font-size:1rem;font-style:italic}table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,0.85)}.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}.admonitionblock>table td.icon{text-align:center;width:80px}.admonitionblock>table td.icon img{max-width:none}.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans", "DejaVu Sans", sans-serif;text-transform:uppercase}.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,0.6);word-wrap:anywhere}.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}.exampleblock>.content{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#fffef7;border-radius:4px;box-shadow:0 1px 4px #e0e0dc}.exampleblock>.content>:first-child{margin-top:0}.exampleblock>.content>:last-child{margin-bottom:0}.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}.sidebarblock>:first-child{margin-top:0}.sidebarblock>:last-child{margin-bottom:0}.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:0.8125em}@media screen and (min-width: 768px){.literalblock pre,.listingblock>.content>pre{font-size:0.90625em}}@media screen and (min-width: 1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,0.9)}.listingblock>.content{position:relative}.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:0.5}.listingblock:hover code[data-lang]::before{display:block}.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:0.5}.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}.listingblock pre.highlightjs{padding:0}.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}.listingblock pre.prettyprint{border-width:0}.prettyprint{background:#f7f7f8}pre.prettyprint .linenums{line-height:1.45;margin-left:2em}pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}pre.prettyprint li code[data-lang]::before{opacity:1}pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}table.linenotable td.code{padding-left:0.75em}table.linenotable td.linenos{width:0.01%}table.linenotable td.linenos,pre.pygments .linenos,pre.rouge .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}pre.pygments span.linenos,pre.rouge span.linenos{display:inline-block;margin-right:0.75em}.quoteblock{margin:0 1em 1.25em 1.5em;display:table}.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:0.75em}.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,0.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}.quoteblock blockquote{margin:0;padding:0;border:0}.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,0.1)}.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}.verseblock{margin:0 1em 1.25em}.verseblock pre{font-family:"Open Sans", "DejaVu Sans", sans-serif;font-size:1.15rem;color:rgba(0,0,0,0.85);font-weight:300;text-rendering:optimizeLegibility}.verseblock pre strong{font-weight:400}.verseblock .attribution{margin-top:1.25rem;margin-left:0.5ex}.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}.quoteblock .attribution br,.verseblock .attribution br{display:none}.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,0.6)}.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}.quoteblock.abstract{margin:0 1em 1.25em;display:block}.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:0.25em solid #dddddf}.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}p.tableblock:last-child{margin-bottom:0}td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}td.tableblock>.content>:last-child{margin-bottom:-1.25em}table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}table.grid-all>*>tr>*{border-width:1px}table.grid-cols>*>tr>*{border-width:0 1px}table.grid-rows>*>tr>*{border-width:1px 0}table.frame-all{border-width:1px}table.frame-ends{border-width:1px 0}table.frame-sides{border-width:0 1px}table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}th.halign-left,td.halign-left{text-align:left}th.halign-right,td.halign-right{text-align:right}th.halign-center,td.halign-center{text-align:center}th.valign-top,td.valign-top{vertical-align:top}th.valign-bottom,td.valign-bottom{vertical-align:bottom}th.valign-middle,td.valign-middle{vertical-align:middle}table thead th,table tfoot th{font-weight:bold}tbody tr th{background:#f7f8f7}tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,0.8);font-weight:bold}p.tableblock>code:only-child{background:none;padding:0}p.tableblock{font-size:1em}ol{margin-left:1.75em}ul li ol{margin-left:1.5em}dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:0.625em}ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:0.625em}ul.unstyled,ol.unstyled{margin-left:0}li>p:empty:only-child::before{content:"";display:inline-block}ul.checklist>li>p:first-child{margin-left:-1em}ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:0.125em}ul.checklist>li>p:first-child>input[type=checkbox]:first-child{font:inherit;margin:0 .25em 0 0;padding:0}ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 0.625em -1.25em}ul.inline>li{margin-left:1.25em}.unstyled dl dt{font-weight:400;font-style:normal}ol.arabic{list-style-type:decimal}ol.decimal{list-style-type:decimal-leading-zero}ol.loweralpha{list-style-type:lower-alpha}ol.upperalpha{list-style-type:upper-alpha}ol.lowerroman{list-style-type:lower-roman}ol.upperroman{list-style-type:upper-roman}ol.lowergreek{list-style-type:lower-greek}.hdlist>table,.colist>table{border:0;background:none}.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}td.hdlist1,td.hdlist2{vertical-align:top;padding:0 0.625em}td.hdlist1{font-weight:bold;padding-bottom:1.25em}td.hdlist2{word-wrap:anywhere}.literalblock+.colist,.listingblock+.colist{margin-top:-0.5em}.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}.colist td:not([class]):first-child img{max-width:none}.colist td:not([class]):last-child{padding:0.25em 0}.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}.imageblock.left{margin:0.25em 0.625em 1.25em 0}.imageblock.right{margin:0.25em 0 1.25em 0.625em}.imageblock>.title{margin-bottom:0}.imageblock.thumb,.imageblock.th{border-width:6px}.imageblock.thumb>.title,.imageblock.th>.title{padding:0 0.125em}.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}.image.left{margin-right:0.625em}.image.right{margin-left:0.625em}a.image{text-decoration:none;display:inline-block}a.image object{pointer-events:none}sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}sup.footnote a,sup.footnoteref a{text-decoration:none}sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:0.625em}#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:0.2em}#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}#footnotes .footnote:last-of-type{margin-bottom:0}#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:0.75em 0}div.page-break{display:none}div.unbreakable{page-break-inside:avoid}.big{font-size:larger}.small{font-size:smaller}.underline{text-decoration:underline}.overline{text-decoration:overline}.line-through{text-decoration:line-through}.aqua{color:#00bfbf}.aqua-background{background:#00fafa}.black{color:#000}.black-background{background:#000}.blue{color:#0000bf}.blue-background{background:#0000fa}.fuchsia{color:#bf00bf}.fuchsia-background{background:#fa00fa}.gray{color:#606060}.gray-background{background:#7d7d7d}.green{color:#006000}.green-background{background:#007d00}.lime{color:#00bf00}.lime-background{background:#00fa00}.maroon{color:#600000}.maroon-background{background:#7d0000}.navy{color:#000060}.navy-background{background:#00007d}.olive{color:#606000}.olive-background{background:#7d7d00}.purple{color:#600060}.purple-background{background:#7d007d}.red{color:#bf0000}.red-background{background:#fa0000}.silver{color:#909090}.silver-background{background:#bcbcbc}.teal{color:#006060}.teal-background{background:#007d7d}.white{color:#bfbfbf}.white-background{background:#fafafa}.yellow{color:#bfbf00}.yellow-background{background:#fafa00}span.icon>.fa{cursor:default}a span.icon>.fa{cursor:inherit}.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,0.5);cursor:default}.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,0.8);color:#111}.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}.conum[data-value]{display:inline-block;color:#fff !important;background:rgba(0,0,0,0.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans", "DejaVu Sans", sans-serif;font-style:normal;font-weight:bold}.conum[data-value] *{color:#fff !important}.conum[data-value]+b{display:none}.conum[data-value]::after{content:attr(data-value)}pre .conum[data-value]{position:relative;top:-0.125em}b.conum *{color:inherit !important}.conum:not([data-value]):empty{display:none}dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}h1,h2,p,td.content,span.alt,summary{letter-spacing:-0.01em}p strong,td.content strong,div.footnote strong{letter-spacing:-0.005em}p,blockquote,dt,td.content,span.alt,summary{font-size:1.0625rem}.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}.print-only{display:none !important}@page{margin:1.25cm 0.75cm}@media print{*{box-shadow:none !important;text-shadow:none !important}html{font-size:80%}a{color:inherit !important;text-decoration:underline !important}a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none !important}a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:0.25em}abbr[title]{border-bottom:1px dotted}abbr[title]::after{content:" (" attr(title) ")"}pre,blockquote,tr,img,object,svg{page-break-inside:avoid}thead{display:table-header-group}p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}body>div[id]{max-width:none}#toc,.sidebarblock,.exampleblock>.content{background:none !important}#toc{border-bottom:1px solid #dddddf !important;padding-bottom:0 !important}body.book #header{text-align:center}body.book #header>h1:first-child{border:0 !important;margin:2.5em 0 1em}body.book #header .details{border:0 !important;display:block;padding:0 !important}body.book #header .details span:first-child{margin-left:0 !important}body.book #header .details br{display:block}body.book #header .details br+span::before{content:none !important}body.book #toc{border:0 !important;text-align:left !important;padding:0 !important;margin:0 !important}body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}.listingblock code[data-lang]::before{display:block}div.page-break{display:block;page-break-after:always}#footer{padding:0 0.9375em}.hide-on-print{display:none !important}.print-only{display:block !important}.hide-for-print{display:none !important}.show-for-print{display:inherit !important}}@media amzn-kf8, print{#header>h1:first-child{margin-top:1.25rem}.sect1{padding:0 !important}.sect1+.sect1{border:0}#footer{background:none}#footer-text{color:rgba(0,0,0,0.6);font-size:0.9em}}@media amzn-kf8{body>div[id]{padding:0}}body{padding:0;margin:0;margin-top:70px !important}.container{position:relative;z-index:1;padding-top:50px;min-height:100%}.container p{font-family:sans-serif;font-size:1.2em}nav{position:fixed;z-index:9999;left:0;right:0;top:0;height:70px;padding:0 1.5em;background-color:#025d8c;font-family:sans-serif;line-height:70px}nav .logo{width:50px;vertical-align:middle}nav .nav-menu{position:absolute;right:0.3em;top:0;padding:0;margin:0;list-style:none}nav .nav-item{display:inline-block}nav .nav-item>a{display:inline-block;padding:0 2.5em;line-height:70px;color:#fff;text-decoration:none}nav .dropdown{position:relative}nav .dropdown a::after{content:"";display:inline-block;margin-left:0.5em;vertical-align:middle;border-top:0.3em solid #fff;border-right:0.3em solid transparent;border-left:0.3em solid transparent}nav .dropdown.show a::after{transform:rotate(180deg)}nav .dropdown-menu{display:none;position:absolute;left:0;right:0;top:100%;padding:0.5em 0;margin-top:-0.5em;border:1px solid rgba(0,0,0,0.3);border-radius:0.5em;background-color:#fff;width:max-content}nav .dropdown-menu-left{left:auto;right:0}nav .dropdown.show .dropdown-menu{display:block}nav .dropdown-div{display:block;padding:0.4em 0;line-height:4em}nav .dropdown-div a::after{content:none;margin-left:0;border-top:0;border-right:0;border-left:0}nav .dropdown-item{display:block;padding:0 1.5em;font-size:0.875em;color:#000;line-height:1.6em;text-decoration:none}nav .btn-hamburger{display:none;position:absolute;right:1.5em;top:50%;background-color:transparent;border:0;cursor:pointer;outline:none;transform:translateY(-50%)}nav .btn-hamburger span{display:block;width:30px;height:4px;background-color:#fff;margin:6px;border-radius:2px;transition:0.3s ease-in-out}nav .btn-hamburger span:nth-child(4),nav .btn-hamburger span:nth-child(5){position:absolute;top:10px;opacity:0.5}nav .btn-hamburger span:nth-child(4){transform:rotate(45deg) scale(0)}nav .btn-hamburger span:nth-child(5){transform:rotate(-45deg) scale(0)}nav.opened .btn-hamburger span:nth-child(4){opacity:1;transform:rotate(45deg) scale(1)}nav.opened .btn-hamburger span:nth-child(5){opacity:1;transform:rotate(-45deg) scale(1)}nav.opened .btn-hamburger span:nth-child(1),nav.opened .btn-hamburger span:nth-child(2),nav.opened .btn-hamburger span:nth-child(3){opacity:0}@media screen and (max-width: 768px){nav .nav-menu{position:fixed;left:0;right:0;top:70px;bottom:100%;display:flex;flex-direction:column;justify-content:start;background-color:#363d4e;transition:bottom 0.5s ease-in-out;overflow:hidden}nav.opened .nav-menu{bottom:0}nav .nav-item>a{display:block}nav .dropdown-menu{position:relative;top:0;margin:0 1.5em}nav .btn-hamburger{display:block}}@media screen{div.narrow{max-width:1080px;margin:0 auto !important;margin-top:70px auto !important;float:none !important}#toc.toc2{margin-top:70px !important}}

</style>
<!-- docinfo -->
</head>
<body class="book toc2 toc-left">
    <div id="wrap">
      <script src="/js/versions.js"></script>
      <script src="/js/nav.js"></script>
      <script>
        document.open();
        document.write(buildNavigation());
        addNavbarListeners();
        document.close();
      </script>
    </div>
<div id="header">
<h1>Upgrading and Updating Red&#160;Hat Satellite</h1>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#providing-feedback-on-red-hat-documentation_upgrade-guide">Providing feedback on Red Hat documentation</a></li>
<li><a href="#upgrading_overview">1. Upgrading Overview</a>
<ul class="sectlevel2">
<li><a href="#upgrading_prerequisites">1.1. Prerequisites</a></li>
<li><a href="#upgrade_paths">1.2. Upgrade Paths</a></li>
<li><a href="#following_the_progress_of_the_upgrade">1.3. Following the Progress of the Upgrade</a></li>
<li><a href="#Upgrading_Proxies_Separately_from_Server_upgrade-guide">1.4. Upgrading Capsules Separately from Satellite</a></li>
</ul>
</li>
<li><a href="#cloning_satellite_server">2. Cloning Satellite&#160;Server</a>
<ul class="sectlevel2">
<li><a href="#sec-Cloning_Workflow_Overview">2.1. Cloning Process Overview</a></li>
<li><a href="#sec-Cloning_Prerequisites">2.2. Prerequisites</a></li>
<li><a href="#sec-Pulp_Data_Considerations">2.3. Pulp Data Considerations</a></li>
<li><a href="#sec_Cloning_Satellite_Server">2.4. Cloning Satellite&#160;Server</a></li>
</ul>
</li>
<li><a href="#upgrading_satellite">3. Upgrading Red&#160;Hat Satellite</a>
<ul class="sectlevel2">
<li><a href="#Upgrading_Server_upgrade-guide">3.1. Upgrading Satellite&#160;Server</a></li>
<li><a href="#synchronizing_the_new_repositories_upgrade-guide">3.2. Synchronizing the New Repositories</a></li>
<li><a href="#upgrading_capsule_server">3.3. Upgrading Capsule&#160;Servers</a></li>
<li><a href="#Upgrading_the_External_Database_upgrade-guide">3.4. Upgrading the External Database</a></li>
<li><a href="#performing-post-upgrade-tasks_upgrade-guide">3.5. Performing Post-Upgrade Tasks</a></li>
</ul>
</li>
<li><a href="#updating_satellite">4. Updating Satellite&#160;Server, Capsule&#160;Server, and Content Hosts</a>
<ul class="sectlevel2">
<li><a href="#updating_satellite_server_to_next_minor_version">4.1. Updating Satellite&#160;Server</a></li>
<li><a href="#_updating_disconnected_satelliteserver">4.2. Updating Disconnected Satellite&#160;Server</a></li>
<li><a href="#updating_capsule_server_to_next_minor_version">4.3. Updating Capsule&#160;Server</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>In this guide, the terms upgrade, update, and migrate have the following meanings:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Upgrading</dt>
<dd>
<p>The process of advancing your Satellite&#160;Server and Capsule&#160;Server installations from a y-stream release to the next, for example Satellite 6.11 to Satellite 6.12.
For more information, see <a href="#upgrading_overview">Upgrading Overview</a>.</p>
</dd>
<dt class="hdlist1">Updating</dt>
<dd>
<p>The process of advancing your Satellite&#160;Server and Capsule&#160;Server installations from a z-stream release to the next, for example Satellite 6.12.0 to Satellite 6.12.1.
For more information, see <a href="#updating_satellite">Updating Satellite&#160;Server, Capsule&#160;Server, and Content Hosts</a>.</p>
</dd>
<dt class="hdlist1">Migrating</dt>
<dd>
<p>The process of moving an existing Satellite installation to a new instance.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect1">
<h2 id="providing-feedback-on-red-hat-documentation_upgrade-guide"><a class="anchor" href="#providing-feedback-on-red-hat-documentation_upgrade-guide"></a>Providing feedback on Red Hat documentation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We appreciate your input on our documentation. Please let us know how we could make it better.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>For simple comments on specific passages:</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Ensure you are viewing the documentation in the <em>Multi-page HTML</em> format.</p>
<div class="paragraph">
<p>In addition, ensure you see the <strong>Feedback</strong> button in the upper right corner of the document.</p>
</div>
</li>
<li>
<p>Use your mouse cursor to highlight the part of text that you want to comment on.</p>
</li>
<li>
<p>Click the <strong>Add Feedback</strong> pop-up that appears below the highlighted text.</p>
</li>
<li>
<p>Follow the displayed instructions.</p>
</li>
</ol>
</div>
</li>
<li>
<p>For submitting feedback via Bugzilla, create a new ticket:</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Go to the <a href="https://bugzilla.redhat.com/enter_bug.cgi?product=Red%20Hat%20Satellite">Bugzilla</a> website.</p>
</li>
<li>
<p>As the Component, use <strong>Documentation</strong>.</p>
</li>
<li>
<p>Fill in the <strong>Description</strong> field with your suggestion for improvement. Include a link to the relevant part(s) of documentation.</p>
</li>
<li>
<p>Click <strong>Submit Bug</strong>.</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="upgrading_overview"><a class="anchor" href="#upgrading_overview"></a>1. Upgrading Overview</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Review prerequisites and available upgrade paths below before upgrading your current Red&#160;Hat Satellite installation to Red&#160;Hat Satellite 6.12.</p>
</div>
<div class="paragraph">
<p>For interactive upgrade instructions, you can also use the Red&#160;Hat Satellite Upgrade Helper on the Red&#160;Hat Customer Portal.
This application provides you with an exact guide to match your current version number.
You can find instructions that are specific to your upgrade path, as well as steps to prevent known issues.
For more information, see <a href="https://access.redhat.com/labs/satelliteupgradehelper/">Satellite Upgrade Helper</a> on the Red&#160;Hat Customer Portal.</p>
</div>
<div class="paragraph">
<p>Note that you can upgrade Capsules separately from Satellite.
For more information, see <a href="#Upgrading_Proxies_Separately_from_Server_upgrade-guide">Upgrading Capsules Separately from Satellite</a>.</p>
</div>
<div class="sect2">
<h3 id="upgrading_prerequisites"><a class="anchor" href="#upgrading_prerequisites"></a>1.1. Prerequisites</h3>
<div class="paragraph">
<p>Upgrading to Satellite 6.12 affects your entire Satellite infrastructure.
Before proceeding, complete the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Read the Red&#160;Hat Satellite 6.12 <a href="https://access.redhat.com/documentation/en-us/red_hat_satellite/6.12/html-single/release_notes/index#">Release Notes</a>.</p>
</li>
<li>
<p>Plan your upgrade path.
For more information, see <a href="#upgrade_paths">Upgrade Paths</a>.</p>
</li>
<li>
<p>Plan for the required downtime. Satellite services are shut down during the upgrade.
The upgrade process duration might vary depending on your hardware configuration, network speed, and the amount of data that is stored on the server.</p>
<div class="paragraph">
<p>Upgrading Satellite takes approximately 1&#8202;&#8211;&#8202;2 hours.</p>
</div>
<div class="paragraph">
<p>Upgrading Capsule takes approximately 10&#8202;&#8211;&#8202;30 minutes.</p>
</div>
</li>
<li>
<p>Ensure that you have sufficient storage space on your server.
For more information, see <a href="https://access.redhat.com/documentation/en-us/red_hat_satellite/6.12/html-single/installing_satellite_server_in_a_connected_network_environment/index#Preparing_your_Environment_for_Installation_satellite">Preparing your Environment for Installation</a> in <em>Installing Satellite&#160;Server in a Connected Network Environment</em> and <a href="https://access.redhat.com/documentation/en-us/red_hat_satellite/6.12/html-single/installing_capsule_server/index#preparing-environment-for-capsule-installation">Preparing your Environment for Installation</a> in <em>Installing Capsule Server</em>.</p>
</li>
<li>
<p>Back up your Satellite&#160;Server and all Capsule&#160;Servers.
For more information, see <a href="https://access.redhat.com/documentation/en-us/red_hat_satellite/6.12/html-single/administering_red_hat_satellite/index#backing-up-satellite-server-and-capsule_admin">Backing Up Satellite&#160;Server and Capsule&#160;Server</a> in <em>Administering Red&#160;Hat Satellite</em>.</p>
</li>
<li>
<p>Plan for updating any scripts you use that contain Satellite API commands because some API commands differ between versions of Satellite.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Satellite 6.12 is released only on Red&#160;Hat Enterprise Linux 8.
If you are running Satellite 6.11 on Red&#160;Hat Enterprise Linux 7, you must upgrade to Red&#160;Hat Enterprise Linux 8 before you can upgrade to Satellite 6.12.
For more information about upgrading from Red&#160;Hat Enterprise Linux 7 to Red&#160;Hat Enterprise Linux 8, see <a href="https://access.redhat.com/documentation/en-us/red_hat_satellite/6.11/html/upgrading_and_updating_red_hat_satellite/upgrading-satellite-or-proxy-in-place-using-leapp_upgrade-guide">Upgrading Satellite or Capsule 6.11 to Red&#160;Hat Enterprise Linux 8 In-Place Using Leapp</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Ensure that all Satellite&#160;Servers are on the same version.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
If you customize configuration files, manually or using a tool such as Hiera, these changes are overwritten when the installation script runs during upgrading or updating.
You can use the <code>--noop</code> option with the satellite-installer script to test for changes.
For more information, see the Red Hat Knowledgebase solution <a href="https://access.redhat.com/solutions/3351311">How to use the noop option to check for changes in Satellite config files during an upgrade.</a>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="upgrade_paths"><a class="anchor" href="#upgrade_paths"></a>1.2. Upgrade Paths</h3>
<div class="paragraph">
<p>You can upgrade to Red&#160;Hat Satellite 6.12 from Red&#160;Hat Satellite 6.11.</p>
</div>
<div class="paragraph">
<p>Satellite&#160;Servers and Capsule&#160;Servers on earlier versions must first be upgraded to Satellite 6.11.
For more information, see the <a href="https://access.redhat.com/documentation/en-us/red_hat_satellite/6.11/html/upgrading_and_updating_red_hat_satellite/"><em>Upgrading and Updating Red&#160;Hat Satellite to 6.11</em></a>.</p>
</div>
<div class="paragraph">
<div class="title">High-Level Upgrade Steps</div>
<p>The high-level steps in upgrading Satellite to 6.12 are as follows:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Optional: Clone your existing Satellite&#160;Servers. For more information, see <a href="#cloning_satellite_server">Cloning Satellite&#160;Server</a>.</p>
</li>
<li>
<p>Upgrade Satellite&#160;Server to 6.12.
For more information, see <a href="#Upgrading_Server_upgrade-guide">Upgrading Satellite&#160;Server</a>.</p>
</li>
<li>
<p>Upgrade all Capsule&#160;Servers to 6.12.
For more information, see <a href="#upgrading_capsule_server">Upgrading Capsule&#160;Servers</a>.</p>
</li>
<li>
<p>Continue with <a href="#performing-post-upgrade-tasks_upgrade-guide">Performing Post-Upgrade Tasks</a>.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="following_the_progress_of_the_upgrade"><a class="anchor" href="#following_the_progress_of_the_upgrade"></a>1.3. Following the Progress of the Upgrade</h3>
<div class="paragraph">
<p>Because of the lengthy upgrade time, use a utility such as <code>tmux</code> to suspend and reattach a communication session.
You can then check the upgrade progress without staying connected to the command shell continuously.
For more information, see the <code>tmux</code> manual page.</p>
</div>
<div class="paragraph">
<p>If you lose connection to the command shell where the upgrade command is running you can see the logs in <code>/var/log/foreman-installer/satellite.log</code> to check if the process completed successfully.</p>
</div>
</div>
<div class="sect2">
<h3 id="Upgrading_Proxies_Separately_from_Server_upgrade-guide"><a class="anchor" href="#Upgrading_Proxies_Separately_from_Server_upgrade-guide"></a>1.4. Upgrading Capsules Separately from Satellite</h3>
<div class="paragraph">
<p>You can upgrade Satellite to version 6.12 and keep Capsules at version 6.11 until you have the capacity to upgrade them too.</p>
</div>
<div class="paragraph">
<p>All the functionality that worked previously works on 6.11 Capsules.
However, the functionality added in the 6.12 release will not work until you upgrade Capsules to 6.12.</p>
</div>
<div class="paragraph">
<p>Upgrading Capsules after upgrading Satellite can be useful in the following example scenarios:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>If you want to have several smaller outage windows instead of one larger window.</p>
</li>
<li>
<p>If Capsules in your organization are managed by several teams and are located in different locations.</p>
</li>
<li>
<p>If you use a load-balanced configuration, you can upgrade one load-balanced Capsule and keep other load-balanced Capsules at one version lower.
This allows you to upgrade all Capsules one after another without any outage.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cloning_satellite_server"><a class="anchor" href="#cloning_satellite_server"></a>2. Cloning Satellite&#160;Server</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When you upgrade Satellite&#160;Server, you can optionally create and upgrade a clone of your Satellite to ensure that you do not lose any data while you upgrade.
After your upgrade is complete, you can then decommission the earlier version of Satellite&#160;Server.</p>
</div>
<div class="paragraph">
<p>You can clone your Satellite&#160;Server to create instances to test upgrades and migration of instances to a different machine or operating system.
This is an optional step to provide more flexibility during the upgrade or migration.</p>
</div>
<div class="paragraph">
<p>The Satellite clone tool does not support migrating a Capsule&#160;Server to Red&#160;Hat Enterprise Linux 8.
Instead, you must backup the existing Capsule&#160;Server, restore it on Red&#160;Hat Enterprise Linux 8, and then reconfigure Capsule&#160;Server.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>If you create a new instance of the Satellite&#160;Server, decomission the old instances after restoring the backup.
Cloned instances are not supposed to run in parallel in a production environment.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<div class="title">Terminology</div>
<p>Ensure that you understand the following terms:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><strong>Source server</strong></dt>
<dd>
<p>The origin of the clone.</p>
</dd>
<dt class="hdlist1"><strong>Target server</strong></dt>
<dd>
<p>The new server that you copy files to and clone the source server to.</p>
</dd>
</dl>
</div>
<div class="sect2">
<h3 id="sec-Cloning_Workflow_Overview"><a class="anchor" href="#sec-Cloning_Workflow_Overview"></a>2.1. Cloning Process Overview</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Back up the source server.</p>
</li>
<li>
<p>Clone the source server to the target server.</p>
</li>
<li>
<p>Power off the source server.</p>
</li>
<li>
<p>Update the network configuration on the target server to match the target server’s IP address with its new host name.</p>
</li>
<li>
<p>Restart <strong>goferd</strong> in Content hosts and Capsules to refresh the connection.</p>
</li>
<li>
<p>Test the new target server.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="sec-Cloning_Prerequisites"><a class="anchor" href="#sec-Cloning_Prerequisites"></a>2.2. Prerequisites</h3>
<div class="paragraph">
<p>To clone Satellite&#160;Server, ensure that you have the following resources available:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A minimal install of Red&#160;Hat Enterprise Linux 8 to become the target server.
Do not install Red&#160;Hat Enterprise Linux 8 software groups or third-party applications.
Ensure that your server complies with all the required specifications.
For more information, see <a href="https://access.redhat.com/documentation/en-us/red_hat_satellite/6.12/html-single/installing_satellite_server_in_a_connected_network_environment/index#Preparing_your_Environment_for_Installation_satellite">Preparing your Environment for Installation</a> in <em>Installing Satellite&#160;Server in a Connected Network Environment</em>.</p>
</li>
<li>
<p>A backup from Satellite 6.11 that you make using the <code>satellite-maintain backup</code> script.
You can use a backup with or without Pulp data.</p>
</li>
<li>
<p>A Satellite subscription for the target server.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Before you begin cloning, ensure the following conditions exist:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The target server is on an isolated network.
This avoids unwanted communication with Capsule&#160;Servers and hosts.</p>
</li>
<li>
<p>The target server has the capacity to store all your backup files from the source server.</p>
</li>
</ul>
</div>
<div class="paragraph">
<div class="title">Customized configuration files</div>
<p>If you have any customized configurations on your source server that are not managed by the <code>satellite-installer</code> tool or Satellite backup process, you must manually back up these files.</p>
</div>
</div>
<div class="sect2">
<h3 id="sec-Pulp_Data_Considerations"><a class="anchor" href="#sec-Pulp_Data_Considerations"></a>2.3. Pulp Data Considerations</h3>
<div class="paragraph">
<p>You can clone Satellite server without including Pulp data.
However, for your cloned environment to work, you do require Pulp data.
If the target server does not have Pulp data. it is not a fully working Satellite.</p>
</div>
<div class="paragraph">
<p>To transfer Pulp data to a target server, you have two options:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Clone using backup with Pulp data</p>
</li>
<li>
<p>Clone using backup without Pulp data and copy <code>/var/lib/pulp</code> manually from the source server.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If your <code>pulp_data.tar</code> file is greater than 500 GB, or if you use a slow storage system, such as NFS, and your <code>pulp_data.tar</code> file is greater than 100 GB, do not include <code>pulp_data.tar</code> in the backup because this can cause memory errors during extraction.
Copy the <code>pulp_data.tar</code> file from the source server to the target server.</p>
</div>
<div class="paragraph">
<div class="title">To back up without Pulp data</div>
<p>Follow the steps in the procedure in <a href="#sec_Cloning_Satellite_Server">Cloning Satellite&#160;Server</a> and replace the steps that involve cloning with Pulp data with the following steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Perform a backup with PostgreSQL databases active excluding the Pulp data:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># satellite-maintain backup offline --skip-pulp-content \
--assumeyes /var/backup</pre>
</div>
</div>
</li>
<li>
<p>Stop and disable Satellite services:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># satellite-maintain service stop
# satellite-maintain service disable</pre>
</div>
</div>
</li>
<li>
<p>Copy the Pulp data to the target server:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># rsync --archive --partial --progress --compress \
/var/lib/pulp <em>target_server.example.com:/var/lib/pulp</em></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>Proceed to <a href="#sec-Cloning_to_Target">Cloning to the Target Server</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="sec_Cloning_Satellite_Server"><a class="anchor" href="#sec_Cloning_Satellite_Server"></a>2.4. Cloning Satellite&#160;Server</h3>
<div class="paragraph">
<p>Use the following procedures to clone Satellite&#160;Server. Note that because of the high volume of data that you must copy and transfer as part of these procedures, it can take a significant amount of time to complete.</p>
</div>
<div class="sect3">
<h4 id="sec-Preparing_Source_Server"><a class="anchor" href="#sec-Preparing_Source_Server"></a>2.4.1. Preparing the source server for cloning</h4>
<div class="paragraph">
<p>On the source server, complete the following steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Verify the Pool ID of your Satellite subscription:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># subscription-manager list --consumed \
--matches 'Red&#160;Hat Satellite'|grep "<em>Pool ID</em>:"|awk '{print $3}'</pre>
</div>
</div>
<div class="paragraph">
<p>Note the <em>Pool ID</em> for later use.</p>
</div>
</li>
<li>
<p>Remove the Red&#160;Hat Satellite subscription:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># subscription-manager remove --serial=$(subscription-manager list \
--consumed \
--matches 'Red&#160;Hat Satellite'|grep "Serial:"|awk '{print $2}')</pre>
</div>
</div>
</li>
<li>
<p>Determine the size of the Pulp data:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># du -sh /var/lib/pulp/</pre>
</div>
</div>
</li>
<li>
<p>If you have less than 500 GB of Pulp data, perform a backup with PostgreSQL databases active including the Pulp data.
If you have more than 500 GB of Pulp data, skip the following steps and complete the steps in <a href="#sec-Pulp_Data_Considerations">Pulp Data Considerations</a> before you continue.</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># satellite-maintain backup offline --assumeyes /var/backup</pre>
</div>
</div>
</li>
<li>
<p>Stop and disable Satellite services:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># satellite-maintain service stop
# satellite-maintain service disable</pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>Proceed to <a href="#sec-Cloning_to_Target">Cloning to the Target Server</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec-Cloning_to_Target"><a class="anchor" href="#sec-Cloning_to_Target"></a>2.4.2. Cloning to the Target Server</h4>
<div class="paragraph">
<p>To clone your server, complete the following steps on your target server:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The <code>satellite-clone</code> tool defaults to using <code>/backup/</code> as the backup folder.
If you copy to a different folder, update the <code>backup_dir</code> variable in the <code>/etc/satellite-clone/satellite-clone-vars.yml</code> file.</p>
</li>
<li>
<p>Place the backup files from the source Satellite in the <code>/backup/</code> folder on the target server.
You can either mount the shared storage or copy the backup files to the <code>/backup/</code> folder on the target server.</p>
</li>
<li>
<p>Power off the source server.</p>
</li>
<li>
<p>Enter the following commands to register to the Customer Portal, attach subscriptions, and enable only the required subscriptions:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># subscription-manager register <em>your_customer_portal_credentials</em>
# subscription-manager attach --pool=<em>pool_ID</em>
# subscription-manager repos --disable=*
# subscription-manager repos --enable=rhel-8-for-x86_64-appstream-rpms \
--enable=satellite-6.11-for-rhel-8-x86_64-rpms \
--enable=satellite-maintenance-6.11-for-rhel-8-x86_64-rpms</pre>
</div>
</div>
</li>
<li>
<p>Install the <code>satellite-clone</code> package:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># dnf install satellite-clone</pre>
</div>
</div>
<div class="paragraph">
<p>After you install the <code>satellite-clone</code> tool, you can adjust any configuration to suit your own deployment in the <code>/etc/satellite-clone/satellite-clone-vars.yml</code> file.</p>
</div>
</li>
<li>
<p>Run the <code>satellite-clone</code> tool:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># satellite-clone</pre>
</div>
</div>
</li>
<li>
<p>Reconfigure DHCP, DNS, TFTP, and remote execution services.
The cloning process disables these services on the target Satellite&#160;Server to avoid conflict with the source Satellite&#160;Server.</p>
</li>
<li>
<p>Reconfigure and enable DHCP, DNS, and TFTP in the Satellite web UI.
For more information, see <a href="https://access.redhat.com/documentation/en-us/red_hat_satellite/6.12/html-single/installing_satellite_server_in_a_connected_network_environment/index#configuring-external-services">Configuring External Services on Satellite&#160;Server</a> in <em>Installing Satellite&#160;Server in a Connected Network Environment</em>.</p>
</li>
<li>
<p>Enable remote execution:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># satellite-installer --scenario satellite \
--enable-foreman-plugin-remote-execution \
--enable-foreman-proxy-plugin-remote-execution-script</pre>
</div>
</div>
</li>
<li>
<p>Log in to the Satellite web UI, with the username <code>admin</code> and the password <code>changeme</code>.
Immediately update the admin password to secure credentials.</p>
</li>
<li>
<p>Ensure that the correct organization is selected.</p>
</li>
<li>
<p>In the Satellite web UI, navigate to <strong>Content</strong> &gt; <strong>Subscriptions</strong>, then click <strong>Manage Manifest</strong>.</p>
</li>
<li>
<p>Click the <strong>Refresh</strong> button, then click <strong>Close</strong> to return to the list of subscriptions.</p>
</li>
<li>
<p>Verify that the available subscriptions are correct.</p>
</li>
<li>
<p>Follow the instructions in the <code>/usr/share/satellite-clone/logs/reassociate_capsules.txt</code> file to restore the associations between Capsules and their lifecycle environments.</p>
</li>
<li>
<p>Update your network configuration, for example, DNS, to match the target server’s IP address with its new host name.
The <code>satellite-clone</code> tool changes the host name to the source server&#8217;s host name.
If you want to change the host name to something different, you can use the <code>satellite-change-hostname</code> tool.
For more information, see <a href="https://access.redhat.com/documentation/en-us/red_hat_satellite/6.12/html-single/administering_red_hat_satellite/index#Renaming_Server_admin">Renaming a Satellite or Capsule&#160;Server</a> in <em>Administering Red&#160;Hat Satellite</em>.</p>
</li>
<li>
<p>If the source server uses the <code>virt-who</code> daemon, install and configure it on the target server.
Copy all the <code>virt-who</code> configuration files in the <code>/etc/virt-who.d/</code> directory from the source server to the same directory on the target server.
For more information, see <a href="https://access.redhat.com/documentation/en-us/red_hat_satellite/6.12/html-single/configuring_virtual_machine_subscriptions_in_red_hat_satellite/index#"><em>Configuring Virtual Machine Subscriptions in Red&#160;Hat Satellite</em></a>.
After you perform an upgrade using the following chapters, you can safely decommission the source server.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="upgrading_satellite"><a class="anchor" href="#upgrading_satellite"></a>3. Upgrading Red&#160;Hat Satellite</h2>
<div class="sectionbody">
<div id="introduction_upgrading_satellite" class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
If you have Satellite installed in a high availability configuration, contact Red&#160;Hat Support before upgrading to Satellite 6.12.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Use the following procedures to upgrade your existing Red&#160;Hat Satellite to Red&#160;Hat Satellite 6.12:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Review <a href="#upgrading_prerequisites">Prerequisites</a>.</p>
</li>
<li>
<p><a href="#Upgrading_Server_upgrade-guide">Upgrading Satellite&#160;Server</a></p>
</li>
<li>
<p><a href="#synchronizing_the_new_repositories_upgrade-guide">Synchronizing the New Repositories</a></p>
</li>
<li>
<p><a href="#upgrading_capsule_server">Upgrading Capsule&#160;Servers</a></p>
</li>
<li>
<p><a href="#performing-post-upgrade-tasks_upgrade-guide">Performing Post-Upgrade Tasks</a></p>
</li>
</ol>
</div>
<div class="sect2">
<h3 id="Upgrading_Server_upgrade-guide"><a class="anchor" href="#Upgrading_Server_upgrade-guide"></a>3.1. Upgrading Satellite&#160;Server</h3>
<div class="paragraph">
<p>This section describes how to upgrade Satellite&#160;Server from 6.11 to 6.12.
You can upgrade from any minor version of Satellite&#160;Server 6.11.</p>
</div>
<div id="upgrading_satellite_server_prerequisites" class="ulist">
<div class="title">Before You Begin</div>
<ul>
<li>
<p>Note that you can upgrade Capsules separately from Satellite.
For more information, see <a href="#Upgrading_Proxies_Separately_from_Server_upgrade-guide">Upgrading Capsules Separately from Satellite</a>.</p>
</li>
<li>
<p>Review and update your firewall configuration prior to upgrading your Satellite&#160;Server.
For more information, see <a href="https://access.redhat.com/documentation/en-us/red_hat_satellite/6.12/html-single/installing_satellite_server_in_a_connected_network_environment/index#Preparing_your_Environment_for_Installation_satellite">Preparing your environment for installation</a> in <em>Installing Satellite&#160;Server in a Connected Network Environment</em>.</p>
</li>
<li>
<p>Ensure that you do not delete the manifest from the Customer Portal or in the Satellite web UI because this removes all the entitlements of your content hosts.</p>
</li>
<li>
<p>If you have edited any of the default job or provisioning templates, back up the files either by cloning or exporting them.
Cloning is the recommended method because that prevents them being overwritten in future updates or upgrades.
To confirm if a template has been edited, you can view its <strong>History</strong> before you upgrade or view the changes in the audit log after an upgrade.
In the Satellite web UI, navigate to <strong>Monitor</strong> &gt; <strong>Audits</strong> and search for the template to see a record of changes made.
If you use the export method, restore your changes by comparing the exported template and the default template, manually applying your changes.</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Capsule Considerations</div>
<ul>
<li>
<p>If you use Content Views to control updates to a Capsule&#160;Server’s base operating system, or for Capsule&#160;Server repository, you must publish updated versions of those Content Views.</p>
</li>
<li>
<p>Note that Satellite&#160;Server upgraded from 6.11 to 6.12 can use Capsule&#160;Servers still at 6.11.</p>
</li>
</ul>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
<div class="paragraph">
<p>If you implemented custom certificates, you must retain the content of both the <code>/root/ssl-build</code> directory and the directory in which you created any source files associated with your custom
certificates.</p>
</div>
<div class="paragraph">
<p>Failure to retain these files during an upgrade causes the upgrade to fail.
If these files have been deleted, they must be restored from a backup in order for the upgrade to proceed.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">Upgrade Scenarios</div>
<ul>
<li>
<p>To upgrade a Satellite&#160;Server connected to the Red&#160;Hat Content Delivery Network, proceed to <a href="#upgrading_a_connected_satellite_server">Upgrading a Connected Satellite&#160;Server</a>.</p>
</li>
<li>
<p>To upgrade a Satellite&#160;Server not connected to the Red&#160;Hat Content Delivery Network, proceed to <a href="#upgrading_a_disconnected_satellite">Upgrading a Disconnected Satellite&#160;Server</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You cannot upgrade a self-registered Satellite.
You must migrate a self-registered Satellite to the Red Hat Content Delivery Network (CDN) and then perform the upgrade.</p>
</div>
<div class="paragraph">
<div class="title">FIPS mode</div>
<p>You cannot upgrade Satellite&#160;Server from a RHEL base system that is not operating in FIPS mode to a RHEL base system that is operating in FIPS mode.</p>
</div>
<div class="paragraph">
<p>To run Satellite&#160;Server on a Red&#160;Hat Enterprise Linux base system operating in FIPS mode, you must install Satellite on a freshly provisioned RHEL base system operating in FIPS mode.
For more information, see <a href="https://access.redhat.com/documentation/en-us/red_hat_satellite/6.12/html-single/installing_satellite_server_in_a_connected_network_environment/index#Preparing_your_Environment_for_Installation_satellite">Preparing your environment for installation</a> in <em>Installing Satellite&#160;Server in a Connected Network Environment</em>.</p>
</div>
<div class="sect3">
<h4 id="upgrading_a_connected_satellite_server"><a class="anchor" href="#upgrading_a_connected_satellite_server"></a>3.1.1. Upgrading a Connected Satellite&#160;Server</h4>
<div class="paragraph">
<p>Use this procedure for a Satellite&#160;Server with access to the public internet</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
If you customize configuration files, manually or using a tool such as Hiera, these changes are overwritten when the installation script runs during upgrading or updating.
You can use the <code>--noop</code> option with the satellite-installer script to test for changes.
For more information, see the Red Hat Knowledgebase solution <a href="https://access.redhat.com/solutions/3351311">How to use the noop option to check for changes in Satellite config files during an upgrade.</a>
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<div class="title">Upgrade Satellite&#160;Server</div>
<ol class="arabic">
<li>
<p>Stop all Satellite services:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># satellite-maintain service stop</pre>
</div>
</div>
</li>
<li>
<p>Take a snapshot or create a backup:</p>
<div class="ulist">
<ul>
<li>
<p>On a virtual machine, take a snapshot.</p>
</li>
<li>
<p>On a physical machine, create a backup.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Start all Satellite services:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># satellite-maintain service start</pre>
</div>
</div>
</li>
<li>
<p>Optional: If you made manual edits to DNS or DHCP configuration in the <code>/etc/zones.conf</code> or <code>/etc/dhcp/dhcpd.conf</code> files, back up the configuration files because the installer only supports one domain or subnet, and therefore restoring changes from these backups might be required.</p>
</li>
<li>
<p>Optional: If you made manual edits to DNS or DHCP configuration files and do not want to overwrite the changes, enter the following command:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># satellite-installer --foreman-proxy-dns-managed=false \
--foreman-proxy-dhcp-managed=false</pre>
</div>
</div>
</li>
<li>
<p>In the Satellite web UI, navigate to <strong>Hosts</strong> &gt; <strong>Discovered hosts</strong>.
On the Discovered Hosts page, power off and then delete the discovered hosts.
From the <strong>Select an Organization</strong> menu, select each organization in turn and repeat the process to power off and delete the discovered hosts.
Make a note to reboot these hosts when the upgrade is complete.</p>
</li>
<li>
<p>In the current upgrade process, you must enable the Satellite 6.12 (or Capsule) repository to restrict any updates outside the Satellite Maintenance repository.
Please read the <a href="https://access.redhat.com/documentation/en-us/red_hat_satellite/6.12/html/release_notes/assembly_introducing-red-hat-satellite_sat6-release-notes#ref_known-issues_assembly_introducing-red-hat-satellite">Known Issues</a> in the Release Notes as a workaround before proceeding further.</p>
<div class="paragraph">
<p>Enable the Satellite Maintenance repository and the Satellite 6.12 repositories:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># subscription-manager repos \
--enable satellite-maintenance-6.12-for-rhel-8-x86_64-rpms \
--enable satellite-6.12-for-rhel-8-x86_64-rpms</pre>
</div>
</div>
<div class="paragraph">
<p>If the Satellite 6.11 system was upgraded from Red&#160;Hat Enterprise Linux 7 to Red&#160;Hat Enterprise Linux 8 using Leapp, manually enable the Satellite module:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># dnf module enable satellite:el8</pre>
</div>
</div>
</li>
<li>
<p>Check the available versions to confirm the version you want is listed:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># satellite-maintain upgrade list-versions</pre>
</div>
</div>
</li>
<li>
<p>Use the health check option to determine if the system is ready for upgrade.
When prompted, enter the hammer admin user credentials to configure <code>satellite-maintain</code> with hammer credentials.
These changes are applied to the <code>/etc/foreman-maintain/foreman-maintain-hammer.yml</code> file.</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># satellite-maintain upgrade check --target-version 6.12</pre>
</div>
</div>
<div class="paragraph">
<p>Review the results and address any highlighted error conditions before performing the upgrade.</p>
</div>
</li>
<li>
<p>Because of the lengthy upgrade time, use a utility such as <code>tmux</code> to suspend and reattach a communication session.
You can then check the upgrade progress without staying connected to the command shell continuously.</p>
<div class="paragraph">
<p>If you lose connection to the command shell where the upgrade command is running you can see the logged messages in the <code>/var/log/foreman-installer/satellite.log</code> file to check if the process completed successfully.</p>
</div>
</li>
<li>
<p>Perform the upgrade:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># satellite-maintain upgrade run --target-version 6.12</pre>
</div>
</div>
</li>
<li>
<p>Determine if the system needs a reboot:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Check the version of newest installed kernel:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># rpm --query --last kernel | head -n 1</pre>
</div>
</div>
</li>
<li>
<p>Compare this to the version of currently running kernel:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># uname --kernel-release</pre>
</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Optional: If the newest kernel differs from the currently running kernel, reboot the system:</p>
<div class="listingblock">
<div class="content">
<pre># reboot</pre>
</div>
</div>
</li>
<li>
<p>If using a BASH shell, after a successful or failed upgrade, enter:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># hash -d satellite-maintain service 2> /dev/null</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="upgrading_a_disconnected_satellite"><a class="anchor" href="#upgrading_a_disconnected_satellite"></a>3.1.2. Upgrading a Disconnected Satellite&#160;Server</h4>
<div class="paragraph">
<p>Use this procedure if your Satellite&#160;Server is not connected to the Red&#160;Hat Content Delivery Network.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>If you customized configuration files, either manually or using a tool such as Hiera, these changes are overwritten when you enter the <code>satellite-maintain</code> command during upgrading or updating.
You can use the <code>--noop</code> option with the <code>satellite-installer</code> command to review the changes that are applied during upgrading or updating.
For more information, see the Red Hat Knowledgebase solution <a href="https://access.redhat.com/solutions/3351311">How to use the noop option to check for changes in Satellite config files during an upgrade</a>.</p>
</li>
<li>
<p>The hammer import and export commands have been replaced with <code>hammer content-import</code> and <code>hammer content-export</code> tooling.</p>
<div class="paragraph">
<p>If you have scripts that are using <code>hammer content-view version export</code>, <code>hammer content-view version export-legacy</code>, <code>hammer repository export</code>, or their respective import commands, you have to adjust them to use the <code>hammer content-export</code> command instead, along with its respective import command.</p>
</div>
</li>
<li>
<p>If you implemented custom certificates, you must retain the content of both the <code>/root/ssl-build</code> directory and the directory in which you created any source files associated with your custom certificates.</p>
<div class="paragraph">
<p>Failure to retain these files during an upgrade causes the upgrade to fail.
If these files have been deleted, they must be restored from a backup in order for the upgrade to proceed.</p>
</div>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">Before You Begin</div>
<ul>
<li>
<p>Review and update your firewall configuration before upgrading your Satellite&#160;Server.
For more information, see <a href="https://access.redhat.com/documentation/en-us/red_hat_satellite/6.12/html-single/installing_satellite_server_in_a_disconnected_network_environment/index#Ports_and_Firewalls_Requirements_satellite">Ports and Firewalls Requirements</a> in <em>Installing Satellite&#160;Server in a Disconnected Network Environment</em>.</p>
</li>
<li>
<p>Ensure that you do not delete the manifest from the Customer Portal or in the Satellite web UI because this removes all the entitlements of your content hosts.</p>
</li>
<li>
<p>Back up and remove all Foreman hooks before upgrading.
Reinstate hooks only after Satellite is known to be working after the upgrade is complete.</p>
</li>
<li>
<p>All Satellite&#160;Servers must be on the same version.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Upgrade Disconnected Satellite&#160;Server</div>
<ol class="arabic">
<li>
<p>Stop all Satellite services:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># satellite-maintain service stop</pre>
</div>
</div>
</li>
<li>
<p>Take a snapshot or create a backup:</p>
<div class="ulist">
<ul>
<li>
<p>On a virtual machine, take a snapshot.</p>
</li>
<li>
<p>On a physical machine, create a backup.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Start all Satellite services:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># satellite-maintain service start</pre>
</div>
</div>
</li>
<li>
<p>Optional: If you made manual edits to DNS or DHCP configuration in the <code>/etc/zones.conf</code> or <code>/etc/dhcp/dhcpd.conf</code> files, back up the configuration files because the installer only supports one domain or subnet, and therefore restoring changes from these backups might be required.</p>
</li>
<li>
<p>Optional: If you made manual edits to DNS or DHCP configuration files and do not want to overwrite the changes, enter the following command:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># satellite-installer --foreman-proxy-dns-managed=false \
--foreman-proxy-dhcp-managed=false</pre>
</div>
</div>
</li>
<li>
<p>In the Satellite web UI, navigate to <strong>Hosts</strong> &gt; <strong>Discovered hosts</strong>.
If there are discovered hosts available, turn them off and then delete all entries under the <code>Discovered hosts</code> page.
Select all other organizations in turn using the organization setting menu and repeat this action as required.
Reboot these hosts after the upgrade has completed.</p>
</li>
<li>
<p>Remove old repositories:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># rm /etc/yum.repos.d/*</pre>
</div>
</div>
</li>
<li>
<p>Obtain the latest ISO files by following the <a href="https://access.redhat.com/documentation/en-us/red_hat_satellite/6.12/html-single/installing_satellite_server_in_a_disconnected_network_environment/index#downloading-the-binary-dvd-images_satellite">Downloading the Binary DVD Images</a> procedure in <em>Installing Satellite&#160;Server in a Disconnected Network Environment</em>.</p>
</li>
<li>
<p>Create directories to serve as a mount point, mount the ISO images, and configure the <code>rhel8</code> repository by following the <a href="https://access.redhat.com/documentation/en-us/red_hat_satellite/6.12/html-single/installing_satellite_server_in_a_disconnected_network_environment/index#configuring-the-base-operating-system-with-offline-repositories-in-rhel-8_satellite">Configuring the Base Operating System with Offline Repositories in RHEL 8</a> procedure in <em>Installing Satellite&#160;Server in a Disconnected Network Environment</em>.</p>
<div class="paragraph">
<p>Do not install or update any packages at this stage.</p>
</div>
</li>
<li>
<p>Configure the Satellite 6.12 repository from the ISO file.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Copy the ISO file&#8217;s repository data file for the Red&#160;Hat Satellite packages:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># cp /media/sat6/Satellite/media.repo /etc/yum.repos.d/satellite.repo</pre>
</div>
</div>
</li>
<li>
<p>Edit the <code>/etc/yum.repos.d/satellite.repo</code> file:</p>
<div class="listingblock">
<div class="content">
<pre># vi /etc/yum.repos.d/satellite.repo</pre>
</div>
</div>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>Change the default <code>InstallMedia</code> repository name to <code>Satellite-6.12</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">[Satellite-6.12]</pre>
</div>
</div>
</li>
<li>
<p>Add the <code>baseurl</code> directive:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">baseurl=file:///media/sat6/Satellite</pre>
</div>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Configure the Red&#160;Hat Satellite Maintenance repository from the ISO file.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Copy the ISO file&#8217;s repository data file for Red&#160;Hat Satellite Maintenance packages:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># cp /media/sat6/Maintenance/media.repo /etc/yum.repos.d/satellite-maintenance.repo</pre>
</div>
</div>
</li>
<li>
<p>Edit the <code>/etc/yum.repos.d/satellite-maintenance.repo</code> file:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># vi /etc/yum.repos.d/satellite-maintenance.repo</pre>
</div>
</div>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>Change the default <code>InstallMedia</code> repository name to <code>Satellite-Maintenance</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">[Satellite-Maintenance]</pre>
</div>
</div>
</li>
<li>
<p>Add the <code>baseurl</code> directive:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">baseurl=file:///media/sat6/Maintenance/</pre>
</div>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Because of the lengthy upgrade time, use a utility such as <code>tmux</code> to suspend and reattach a communication session.
You can then check the upgrade progress without staying connected to the command shell continuously.</p>
<div class="paragraph">
<p>If you lose connection to the command shell where the upgrade command is running you can see the logs in <code>/var/log/foreman-installer/satellite.log</code> to check if the process completed successfully.</p>
</div>
</li>
<li>
<p>Check the available versions to confirm the version you want is listed:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># satellite-maintain upgrade list-versions</pre>
</div>
</div>
</li>
<li>
<p>Use the health check option to determine if the system is ready for upgrade.
When prompted, enter the hammer admin user credentials to configure <code>satellite-maintain</code> with hammer credentials.
These changes are applied to the <code>/etc/foreman-maintain/foreman-maintain-hammer.yml</code> file.</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># satellite-maintain upgrade check --target-version 6.12 \
--whitelist="repositories-validate,repositories-setup"</pre>
</div>
</div>
<div class="paragraph">
<p>Review the results and address any highlighted error conditions before performing the upgrade.</p>
</div>
</li>
<li>
<p>Perform the upgrade:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># satellite-maintain upgrade run --target-version 6.12 \
--whitelist="repositories-validate,repositories-setup"</pre>
</div>
</div>
<div class="paragraph">
<p>If the script fails due to missing or outdated packages, you must download and install these separately.
For more information, see <a href="https://access.redhat.com/documentation/en-us/red_hat_satellite/6.12/html-single/installing_satellite_server_in_a_disconnected_network_environment/index#resolving-package-dependency-errors_satellite">Resolving Package Dependency Errors</a> in <em>Installing Satellite&#160;Server in a Disconnected Network Environment</em>.</p>
</div>
</li>
<li>
<p>If using a BASH shell, after a successful or failed upgrade, enter:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># hash -d satellite-maintain service 2> /dev/null</pre>
</div>
</div>
</li>
<li>
<p>Check when the kernel packages were last updated:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># rpm -qa --last | grep kernel</pre>
</div>
</div>
</li>
<li>
<p>Optional: If a kernel update occurred since the last reboot, stop Satellite services and reboot the system:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># satellite-maintain service stop
# reboot</pre>
</div>
</div>
</li>
<li>
<p>Optional: If you made manual edits to DNS or DHCP configuration files, check and restore any changes required to the DNS and DHCP configuration files using the backups that you made.</p>
</li>
<li>
<p>If you make changes in the previous step, restart Satellite services:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># satellite-maintain service restart</pre>
</div>
</div>
</li>
<li>
<p>If you have the OpenSCAP plug-in installed, but do not have the default OpenSCAP content available, enter the following command.</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># foreman-rake foreman_openscap:bulk_upload:default</pre>
</div>
</div>
</li>
<li>
<p>In the Satellite web UI, go to <strong>Configure</strong> &gt; <strong>Discovery Rules</strong> and associate selected organizations and locations with discovery rules.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="synchronizing_the_new_repositories_upgrade-guide"><a class="anchor" href="#synchronizing_the_new_repositories_upgrade-guide"></a>3.2. Synchronizing the New Repositories</h3>
<div class="paragraph">
<p>You must enable and synchronize the new 6.12 repositories before you can upgrade Capsule&#160;Servers and Satellite clients.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the Satellite web UI, navigate to <strong>Content</strong> &gt; <strong>Red&#160;Hat Repositories</strong>.</p>
</li>
<li>
<p>Toggle the <strong>Recommended Repositories</strong> switch to the <strong>On</strong> position.</p>
</li>
<li>
<p>From the list of results, expand the following repositories and click the <strong>Enable</strong> icon to enable the repositories:</p>
<div class="ulist">
<ul>
<li>
<p>To upgrade Satellite clients, enable the <strong>Red&#160;Hat Satellite Client 6</strong> repositories for all Red&#160;Hat Enterprise Linux versions that clients use.</p>
</li>
<li>
<p>If you have Capsule&#160;Servers, to upgrade them, enable the following repositories too:</p>
<div class="paragraph">
<p><strong>Red&#160;Hat Satellite Capsule 6.12 (for RHEL 8 x86_64) (RPMs)</strong></p>
</div>
<div class="paragraph">
<p><strong>Red&#160;Hat Satellite Maintenance 6.12 (for RHEL 8 x86_64) (RPMs)</strong></p>
</div>
<div class="paragraph">
<p><strong>Red&#160;Hat Enterprise Linux 8 (for x86_64 &#8211; BaseOS) (RPMs)</strong></p>
</div>
<div class="paragraph">
<p><strong>Red&#160;Hat Enterprise Linux 8 (for x86_64 &#8211; AppStream) (RPMs)</strong></p>
</div>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>If the 6.12 repositories are not available, refresh the Red&#160;Hat Subscription Manifest.
In the Satellite web UI, navigate to <strong>Content</strong> &gt; <strong>Subscriptions</strong>, click <strong>Manage Manifest</strong>, then click <strong>Refresh</strong>.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>In the Satellite web UI, navigate to <strong>Content</strong> &gt; <strong>Sync Status</strong>.</p>
</li>
<li>
<p>Click the arrow next to the product to view the available repositories.</p>
</li>
<li>
<p>Select the repositories for 6.12.
Note that <strong>Red&#160;Hat Satellite Client 6</strong> does not have a 6.12 version.
Choose <strong>Red&#160;Hat Satellite Client 6</strong> instead.</p>
</li>
<li>
<p>Click <strong>Synchronize Now</strong>.</p>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
<div class="paragraph">
<p>If an error occurs when you try to synchronize a repository, refresh the manifest.
If the problem persists, raise a support request.
Do not delete the manifest from the Customer Portal or in the Satellite web UI; this removes all the entitlements of your content hosts.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>If you use Content Views to control updates to the base operating system of Capsule&#160;Server, update those Content Views with new repositories, publish, and promote their updated versions.
For more information, see <a href="https://access.redhat.com/documentation/en-us/red_hat_satellite/6.12/html-single/managing_content/index#Managing_Content_Views_content-management">Managing Content Views</a> in <em>Managing Content</em>.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="upgrading_capsule_server"><a class="anchor" href="#upgrading_capsule_server"></a>3.3. Upgrading Capsule&#160;Servers</h3>
<div class="paragraph">
<p>This section describes how to upgrade Capsule&#160;Servers from 6.11 to 6.12.</p>
</div>
<div class="ulist">
<div class="title">Before You Begin</div>
<ul>
<li>
<p>You must upgrade Satellite&#160;Server before you can upgrade any Capsule&#160;Servers.
Note that you can upgrade Capsules separately from Satellite.
For more information, see <a href="#Upgrading_Proxies_Separately_from_Server_upgrade-guide">Upgrading Capsules Separately from Satellite</a>.</p>
</li>
<li>
<p>Ensure the Red&#160;Hat Satellite Capsule 6.12 repository is enabled in Satellite&#160;Server and synchronized.</p>
</li>
<li>
<p>Ensure that you synchronize the required repositories on Satellite&#160;Server.
For more information, see <a href="#synchronizing_the_new_repositories_upgrade-guide">Synchronizing the New Repositories</a>.</p>
</li>
<li>
<p>If you use Content Views to control updates to the base operating system of Capsule&#160;Server, update those Content Views with new repositories, publish, and promote their updated versions.
For more information, see <a href="https://access.redhat.com/documentation/en-us/red_hat_satellite/6.12/html-single/managing_content/index#Managing_Content_Views_content-management">Managing Content Views</a> in <em>Managing Content</em>.</p>
</li>
<li>
<p>Ensure the Capsule&#8217;s base system is registered to the newly upgraded Satellite&#160;Server.</p>
</li>
<li>
<p>Ensure the Capsule has the correct organization and location settings in the newly upgraded Satellite&#160;Server.</p>
</li>
<li>
<p>Review and update your firewall configuration prior to upgrading your Capsule&#160;Server.
For more information, see <a href="https://access.redhat.com/documentation/en-us/red_hat_satellite/6.12/html-single/installing_capsule_server/index#preparing-environment-for-capsule-installation">Preparing Your Environment for Capsule Installation</a> in <em>Installing Capsule Server</em>.</p>
</li>
</ul>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
<div class="paragraph">
<p>If you implemented custom certificates, you must retain the content of both the <code>/root/ssl-build</code> directory and the directory in which you created any source files associated with your custom certificates.</p>
</div>
<div class="paragraph">
<p>Failure to retain these files during an upgrade causes the upgrade to fail.
If these files have been deleted, they must be restored from a backup in order for the upgrade to proceed.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<div class="title">Upgrading Capsule&#160;Servers</div>
<ol class="arabic">
<li>
<p>Create a backup.</p>
<div class="ulist">
<ul>
<li>
<p>On a virtual machine, take a snapshot.</p>
</li>
<li>
<p>On a physical machine, create a backup.</p>
<div class="paragraph">
<p>For information on backups, see <a href="https://access.redhat.com/documentation/en-us/red_hat_satellite/6.12/html-single/administering_red_hat_satellite/index#backing-up-satellite-server-and-capsule_admin">Backing Up Satellite&#160;Server and Capsule&#160;Server</a> in <em>Administering Red&#160;Hat Satellite</em>.</p>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Clean yum cache:</p>
<div class="listingblock">
<div class="content">
<pre># yum clean metadata</pre>
</div>
</div>
</li>
<li>
<p>The <code>rubygem-foreman_maintain</code> is installed from the Satellite Maintenance repository or upgraded from the Satellite Maintenance repository if currently installed.</p>
<div class="paragraph">
<p>In the current upgrade process, you must enable the Satellite 6.12 (or Capsule) repository to restrict any updates outside the Satellite Maintenance repository.
Please read the <a href="https://access.redhat.com/documentation/en-us/red_hat_satellite/6.12/html/release_notes/assembly_introducing-red-hat-satellite_sat6-release-notes#ref_known-issues_assembly_introducing-red-hat-satellite">Known Issues</a> in the Release Notes as a workaround before proceeding further.</p>
</div>
<div class="paragraph">
<p>Ensure Capsule has access to <code>satellite-maintenance-6.12-for-rhel-8-x86_64-rpms</code> and execute:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># subscription-manager repos --enable \
satellite-capsule-6.12-for-rhel-8-x86_64-rpms

# satellite-maintain self-upgrade</pre>
</div>
</div>
<div class="paragraph">
<p>If the Capsule 6.11 system was upgraded from Red&#160;Hat Enterprise Linux 7 to Red&#160;Hat Enterprise Linux 8 using Leapp, manually enable the Capsule module:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># dnf module enable satellite-capsule:el8</pre>
</div>
</div>
</li>
<li>
<p>On Capsule&#160;Server, verify that the <code>foreman_url</code> setting points to the Satellite FQDN:</p>
<div class="listingblock">
<div class="content">
<pre># grep foreman_url /etc/foreman-proxy/settings.yml</pre>
</div>
</div>
</li>
<li>
<p>Check the available versions to confirm the version you want is listed:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># satellite-maintain upgrade list-versions</pre>
</div>
</div>
</li>
<li>
<p>Because of the lengthy upgrade time, use a utility such as <code>tmux</code> to suspend and reattach a communication session.
You can then check the upgrade progress without staying connected to the command shell continuously.</p>
<div class="paragraph">
<p>If you lose connection to the command shell where the upgrade command is running you can see the logged messages in the <code>/var/log/foreman-installer/capsule.log</code> file to check if the process completed successfully.</p>
</div>
</li>
<li>
<p>Use the health check option to determine if the system is ready for upgrade:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># satellite-maintain upgrade check --target-version 6.12</pre>
</div>
</div>
<div class="paragraph">
<p>Review the results and address any highlighted error conditions before performing the upgrade.</p>
</div>
</li>
<li>
<p>Perform the upgrade:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># satellite-maintain upgrade run --target-version 6.12</pre>
</div>
</div>
</li>
<li>
<p>Check when the kernel packages were last updated:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># rpm -qa --last | grep kernel</pre>
</div>
</div>
</li>
<li>
<p>Optional: If a kernel update occurred since the last reboot, reboot the system:</p>
<div class="listingblock">
<div class="content">
<pre># reboot</pre>
</div>
</div>
</li>
<li>
<p>Optional: If you made manual edits to DNS or DHCP configuration files, check and restore any changes required to the DNS and DHCP configuration files using the backups made earlier.</p>
</li>
<li>
<p>Optional: If you use custom repositories, ensure that you enable these custom repositories after the upgrade completes.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="Upgrading_the_External_Database_upgrade-guide"><a class="anchor" href="#Upgrading_the_External_Database_upgrade-guide"></a>3.4. Upgrading the External Database</h3>
<div class="paragraph">
<p>You can upgrade an external database from Red&#160;Hat Enterprise Linux 7 to Red&#160;Hat Enterprise Linux 8 while upgrading Satellite from 6.11 to 6.12.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Create a new Red&#160;Hat Enterprise Linux 8 based host for PostgreSQL server that follows the external database on Red&#160;Hat Enterprise Linux 8 documentation.
For more information, see <a href="https://access.redhat.com/documentation/en-us/red_hat_satellite/6.12/html-single/installing_satellite_server_in_a_connected_network_environment/index#using-external-databases_satellite">Using External Databases with Satellite</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Create a backup.</p>
</li>
<li>
<p>Restore the backup on the new server.</p>
</li>
<li>
<p>If Satellite reaches the new database server via the old name, no further changes are required.
Otherwise reconfigure Satellite to use the new name:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># satellite-installer \
--foreman-db-host <em>newpostgres.example.com</em> \
--katello-candlepin-db-host <em>newpostgres.example.com</em> \
--foreman-proxy-content-pulpcore-postgresql-host <em>newpostgres.example.com</em></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="performing-post-upgrade-tasks_upgrade-guide"><a class="anchor" href="#performing-post-upgrade-tasks_upgrade-guide"></a>3.5. Performing Post-Upgrade Tasks</h3>
<div class="paragraph">
<p>Some of the procedures in this section are optional.
You can choose to perform only those procedures that are relevant to your installation.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#upgrading_discovery_parent">Upgrading Discovery</a></p>
</li>
<li>
<p><a href="#upgrading_virt_who">Upgrading virt-who</a></p>
</li>
<li>
<p><a href="#removing_satellite_tools_repository">Removing the Previous Version of the Satellite Tools Repository</a></p>
</li>
<li>
<p><a href="#migrating-ansible-content_upgrade-guide">Migrating Ansible Content</a></p>
</li>
<li>
<p><a href="#reclaiming-postgresql-space-after-an-upgrade_upgrade-guide">Reclaiming PostgreSQL Space</a></p>
</li>
<li>
<p><a href="#tuning-with-predefined-profiles_upgrade-guide">Tuning Satellite&#160;Server with Predefined Profiles</a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="upgrading_discovery_parent"><a class="anchor" href="#upgrading_discovery_parent"></a>3.5.1. Upgrading Discovery</h4>
<div class="paragraph">
<p>If you use the PXE-based discovery process, then you must complete the discovery upgrade procedure on Satellite and on any Capsule&#160;Server with hosts that you want to be listed in Satellite on the <strong>Hosts</strong> &gt; <strong>Discovered hosts</strong> page.</p>
</div>
<div class="paragraph">
<p>This section describes updating the PXELinux template and the boot image passed to hosts that use PXE booting to register themselves with Satellite&#160;Server.</p>
</div>
<div class="paragraph">
<p>From Satellite&#160;6.12, provisioning templates now have a separate association with a subnet, and do not default to using the TFTP Capsule for that subnet.
If you create subnets after the upgrade, you must specifically enable the Satellite or a Capsule to provide a proxy service for discovery templates and then configure all subnets with discovered hosts to use a specific <em>template Capsule</em>.</p>
</div>
<div class="paragraph">
<p>During the upgrade, for every subnet with a TFTP proxy enabled, the template Capsule is set to be the same as the TFTP Capsule.
After the upgrade, check all subnets to verify this was set correctly.</p>
</div>
<div class="paragraph">
<p>These procedures are not required if you do not use PXE booting of hosts to enable Satellite to discover new hosts.</p>
</div>
<div class="sect4">
<h5 id="upgrading_discovery_satellite"><a class="anchor" href="#upgrading_discovery_satellite"></a>Upgrading Discovery on Satellite&#160;Server</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Update the Discovery template in the Satellite web UI:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>In the Satellite web UI, navigate to <strong>Hosts</strong> &gt; <strong>Provisioning templates</strong>.</p>
</li>
<li>
<p>On the <code>PXELinux global default</code> line, click <strong>Clone</strong>.</p>
</li>
<li>
<p>Enter a new name for the template in the <strong>Name</strong> field, for example <code>ACME PXE global default</code>.</p>
</li>
<li>
<p>In the template editor field, change the line <code>ONTIMEOUT local</code> to <code>ONTIMEOUT discovery</code> and click <strong>Submit</strong>.</p>
</li>
<li>
<p>In the Satellite web UI, navigate to <strong>Administer</strong> &gt; <strong>Settings</strong>.</p>
</li>
<li>
<p>On the <strong>Provisioning</strong> tab, set <code>Default PXE global template entry</code> to a custom value for your environment.</p>
</li>
<li>
<p>Locate <code>Global default PXELinux template</code> and click on its <strong>Value</strong>.</p>
</li>
<li>
<p>Select the name of the newly created template from the menu and click <strong>Submit</strong>.</p>
</li>
<li>
<p>In the Satellite web UI, navigate to <strong>Hosts</strong> &gt; <strong>Provisioning templates</strong>.</p>
</li>
<li>
<p>Click <strong>Build PXE Default</strong>, then click <strong>OK</strong>.</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>If the template is modified, a Satellite upgrade overrides it to its default version.
Once the PXE Default configuration is built, the template configured in the <strong>Settings</strong> is deployed to the TFTP.
This can result in deploying the default template if the new template is correctly set in the <strong>Settings</strong>.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>In the Satellite web UI, go to <strong>Configure</strong> &gt; <strong>Discovery Rules</strong> and associate selected organizations and locations with discovery rules.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="verify_subnets_have_a_template_capsule"><a class="anchor" href="#verify_subnets_have_a_template_capsule"></a>Verifying Subnets have a Template Capsule</h5>
<div class="olist arabic">
<div class="title">Ensure all subnets with discovered hosts have a template Capsule:</div>
<ol class="arabic">
<li>
<p>In the Satellite web UI, navigate to <strong>Infrastructure</strong> &gt; <strong>Subnets</strong>.</p>
</li>
<li>
<p>Select the subnet you want to check.</p>
</li>
<li>
<p>On the <strong>Capsules</strong> tab, ensure a <strong>Template Capsule</strong> has been set for this subnet.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>For more information about configuring subnets with template Capsules, see <a href="https://access.redhat.com/documentation/en-us/red_hat_satellite/6.12/html-single/provisioning_hosts/index#Configuring_the_Discovery_Service_provisioning">Configuring the Discovery Service</a> in <em>Provisioning Hosts</em>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="upgrading_virt_who"><a class="anchor" href="#upgrading_virt_who"></a>3.5.2. Upgrading virt-who</h4>
<div class="paragraph">
<p>If virt-who is installed on Satellite&#160;Server or a Capsule&#160;Server, it will be upgraded when they are upgraded.
No further action is required.
If virt-who is installed elsewhere, it must be upgraded manually.</p>
</div>
<div class="paragraph">
<div class="title">Before You Begin</div>
<p>If virt-who is installed on a host registered to Satellite&#160;Server or a Capsule&#160;Server, first upgrade the host to the latest packages available in the Satellite Client 6 repository.</p>
</div>
<div class="olist arabic">
<div class="title">Upgrade virt-who Manually</div>
<ol class="arabic">
<li>
<p>Upgrade virt-who.</p>
<div class="listingblock">
<div class="content">
<pre># yum upgrade virt-who</pre>
</div>
</div>
</li>
<li>
<p>Restart the virt-who service so the new version is activated.</p>
<div class="listingblock">
<div class="content">
<pre># systemctl restart virt-who</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="removing_satellite_tools_repository"><a class="anchor" href="#removing_satellite_tools_repository"></a>3.5.3. Removing the Previous Version of the Satellite Tools Repository</h4>
<div class="paragraph">
<p>After completing the upgrade to Satellite 6.12, the Red&#160;Hat Satellite Tools 6.11 repository can be removed from Content Views and then disabled.</p>
</div>
<div class="paragraph">
<p>Disable Version 6.11 of the Satellite Tools Repository:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In the Satellite web UI, navigate to <strong>Content</strong> &gt; <strong>Red Hat Repositories</strong>.</p>
</li>
<li>
<p>In the <strong>Enabled Repositories</strong> area, locate <strong>Red&#160;Hat Satellite Tools 6.11 for RHEL 7 Server RPMs x86_64</strong>.</p>
</li>
<li>
<p>Click the <strong>Disable</strong> icon to the right.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>If the repository is still contained in a Content View then you cannot disable it.
Packages from a disabled repository are removed automatically by a scheduled task.</p>
</div>
</div>
<div class="sect3">
<h4 id="migrating-ansible-content_upgrade-guide"><a class="anchor" href="#migrating-ansible-content_upgrade-guide"></a>3.5.4. Migrating Ansible Content</h4>
<div class="paragraph">
<p>The upgrade from Red&#160;Hat Enterprise Linux 7 to Red&#160;Hat Enterprise Linux 8 includes an upgrade from Ansible Engine 2.9 to Ansible Core 2.12.</p>
</div>
<div class="paragraph">
<p>If you have custom Ansible content such as playbooks, job templates inside REX, roles and collections on disk, and you rely on modules being delivered by the Ansible RPM on Satellite, you have to take additional steps to adapt your Ansible installation or migrate your Ansible content.</p>
</div>
<div class="paragraph">
<p>Ansible Core contains only essential modules.
In terms of FQCN notation <code>namespace.collection.module</code>, you can continue to use <code>ansible.builtin.*</code>, but everything else is missing in Ansible Core.
That means you will be no longer able to use non-builtin Ansible modules as you were used to and you have to get them from another source, eventually.</p>
</div>
<div class="paragraph">
<p>You have the following options to handle your Ansible content after the upgrade:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>You can obtain additional community-maintained collections that provide the non-essential functionality from Ansible Galaxy.
For more information, see <a href="https://docs.ansible.com/ansible/latest/galaxy/user_guide.html#installing-collections">Installing collections</a> in the <em>Galaxy User Guide</em>.</p>
<div class="paragraph">
<p>Note that Red&#160;Hat does not provide support for this content.</p>
</div>
</li>
<li>
<p>If you have a subscription for <a href="https://www.ansible.com/products/automation-hub">Red Hat Automation Hub</a>, you can configure your <code>ansible-galaxy</code> to talk to Automation Hub server and download content from there.
That content is supported by Red&#160;Hat.
For more information on configuring Automation Hub connection for <code>ansible-galaxy</code>, see <a href="https://access.redhat.com/documentation/en-us/red_hat_ansible_automation_platform/2.1/html/getting_started_with_automation_hub/proc-configure-automation-hub-server-cli">Configuring Red Hat automation hub as the primary source for content</a>.</p>
</li>
<li>
<p>You can rewrite your Ansible roles, templates and other affected content.
Note that Red&#160;Hat does not provide support for content that you maintain yourself.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>If you want to download and install Ansible content on Capsule that does not have a connection to an external Ansible Galaxy server, then you must pass the content through Satellite&#160;Server instead of using the URL of the Ansible Galaxy server in the configuration on the Capsule directly:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Sync the content from a Ansible Galaxy server to a custom repository on your Satellite&#160;Server.</p>
</li>
<li>
<p>Configure Ansible on your Capsule to download the content from Satellite&#160;Server.</p>
</li>
</ol>
</div>
</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="https://www.redhat.com/en/blog/updates-using-ansible-rhel-86-and-90">Updates to using Ansible in RHEL 8.6 and 9.0</a></p>
</li>
<li>
<p><a href="https://access.redhat.com/articles/6393361">Using Ansible in RHEL 8.6 and later</a></p>
</li>
<li>
<p><a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/8.6_release_notes/index">Release Notes for Red Hat Enterprise Linux 8.6</a></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="reclaiming-postgresql-space-after-an-upgrade_upgrade-guide"><a class="anchor" href="#reclaiming-postgresql-space-after-an-upgrade_upgrade-guide"></a>3.5.5. Reclaiming PostgreSQL Space</h4>
<div class="paragraph">
<p>The PostgreSQL database can use a large amount of disk space especially in heavily loaded deployments.
Use this procedure to reclaim some of this disk space on Satellite.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Stop all services, except for the <code>postgresql</code> service:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># satellite-maintain service stop --exclude postgresql</pre>
</div>
</div>
</li>
<li>
<p>Switch to the <code>postgres</code> user and reclaim space on the database:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># su - postgres -c 'vacuumdb --full --all'</pre>
</div>
</div>
</li>
<li>
<p>Start the other services when the vacuum completes:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># satellite-maintain service start</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="tuning-with-predefined-profiles_upgrade-guide"><a class="anchor" href="#tuning-with-predefined-profiles_upgrade-guide"></a>3.5.6. Tuning Satellite&#160;Server with Predefined Profiles</h4>
<div class="paragraph">
<p>If your Satellite deployment includes more than 5000 hosts, you can use predefined tuning profiles to improve performance of Satellite.</p>
</div>
<div class="paragraph">
<p>Note that you cannot use tuning profiles on Capsules.</p>
</div>
<div class="paragraph">
<p>You can choose one of the profiles depending on the number of hosts your Satellite manages and available hardware resources.</p>
</div>
<div class="paragraph">
<p>The tuning profiles are available in the <code>/usr/share/foreman-installer/config/foreman.hiera/tuning/sizes</code> directory.</p>
</div>
<div class="paragraph">
<p>When you run the <code>satellite-installer</code> command with the <code>--tuning</code> option, deployment configuration settings are applied to Satellite in the following order:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The default tuning profile defined in the <code>/usr/share/foreman-installer/config/foreman.hiera/tuning/common.yaml</code> file</p>
</li>
<li>
<p>The tuning profile that you want to apply to your deployment and is defined in the <code>/usr/share/foreman-installer/config/foreman.hiera/tuning/sizes/</code> directory</p>
</li>
<li>
<p>Optional: If you have configured a <code>/etc/foreman-installer/custom-hiera.yaml</code> file, Satellite applies these configuration settings.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Note that the configuration settings that are defined in the <code>/etc/foreman-installer/custom-hiera.yaml</code> file override the configuration settings that are defined in the tuning profiles.</p>
</div>
<div class="paragraph">
<p>Therefore, before applying a tuning profile, you must compare the configuration settings that are defined in the default tuning profile in <code>/usr/share/foreman-installer/config/foreman.hiera/tuning/common.yaml</code>, the tuning profile that you want to apply and your <code>/etc/foreman-installer/custom-hiera.yaml</code> file, and remove any duplicated configuration from the <code>/etc/foreman-installer/custom-hiera.yaml</code> file.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">default</dt>
<dd>
<p>Number of managed hosts: 0&#8202;&#8211;&#8202;5000</p>
<div class="paragraph">
<p>RAM: 20G</p>
</div>
<div class="paragraph">
<p>Number of CPU cores: 4</p>
</div>
</dd>
<dt class="hdlist1">medium</dt>
<dd>
<p>Number of managed hosts: 5001&#8202;&#8211;&#8202;10000</p>
<div class="paragraph">
<p>RAM: 32G</p>
</div>
<div class="paragraph">
<p>Number of CPU cores: 8</p>
</div>
</dd>
<dt class="hdlist1">large</dt>
<dd>
<p>Number of managed hosts: 10001&#8202;&#8211;&#8202;20000</p>
<div class="paragraph">
<p>RAM: 64G</p>
</div>
<div class="paragraph">
<p>Number of CPU cores: 16</p>
</div>
</dd>
<dt class="hdlist1">extra-large</dt>
<dd>
<p>Number of managed hosts: 20001&#8202;&#8211;&#8202;60000</p>
<div class="paragraph">
<p>RAM: 128G</p>
</div>
<div class="paragraph">
<p>Number of CPU cores: 32</p>
</div>
</dd>
<dt class="hdlist1">extra-extra-large</dt>
<dd>
<p>Number of managed hosts: 60000+</p>
<div class="paragraph">
<p>RAM: 256G</p>
</div>
<div class="paragraph">
<p>Number of CPU cores: 48+</p>
</div>
</dd>
</dl>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Optional: If you have configured the <code>custom-hiera.yaml</code> file on Satellite&#160;Server, back up the <code>/etc/foreman-installer/custom-hiera.yaml</code> file to <code>custom-hiera.original</code>.
You can use the backup file to restore the <code>/etc/foreman-installer/custom-hiera.yaml</code> file to its original state if it becomes corrupted:</p>
<div class="listingblock">
<div class="content">
<pre># cp /etc/foreman-installer/custom-hiera.yaml \
/etc/foreman-installer/custom-hiera.original</pre>
</div>
</div>
</li>
<li>
<p>Optional: If you have configured the <code>custom-hiera.yaml</code> file on Satellite&#160;Server, review the definitions of the default tuning profile in <code>/usr/share/foreman-installer/config/foreman.hiera/tuning/common.yaml</code> and the tuning profile that you want to apply in <code>/usr/share/foreman-installer/config/foreman.hiera/tuning/sizes/</code>.
Compare the configuration entries against the entries in your <code>/etc/foreman-installer/custom-hiera.yaml</code> file and remove any duplicated configuration settings in your <code>/etc/foreman-installer/custom-hiera.yaml</code> file.</p>
</li>
<li>
<p>Enter the <code>satellite-installer</code> command with the <code>--tuning</code> option for the profile that you want to apply.
For example, to apply the medium tuning profile settings, enter the following command:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># satellite-installer --tuning medium</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="updating_satellite"><a class="anchor" href="#updating_satellite"></a>4. Updating Satellite&#160;Server, Capsule&#160;Server, and Content Hosts</h2>
<div class="sectionbody">
<div id="introduction_updating_satellite" class="paragraph">
<p>Use this chapter to update your existing Satellite&#160;Server, Capsule&#160;Server, and Content Hosts to a new patch version, for example, from 6.12.0 to 6.12.1.</p>
</div>
<div class="paragraph">
<p>Updates patch security vulnerabilities and minor issues discovered after code is released, and are often fast and non-disruptive to your operating environment.</p>
</div>
<div class="paragraph">
<p>Before updating, back up your Satellite&#160;Server and all Capsule&#160;Servers.
For more information, see <a href="https://access.redhat.com/documentation/en-us/red_hat_satellite/6.12/html-single/administering_red_hat_satellite/index#backing-up-satellite-server-and-capsule_admin">Backing Up Satellite&#160;Server and Capsule&#160;Server</a> in <em>Administering Red&#160;Hat Satellite</em>.</p>
</div>
<div class="sect2">
<h3 id="updating_satellite_server_to_next_minor_version"><a class="anchor" href="#updating_satellite_server_to_next_minor_version"></a>4.1. Updating Satellite&#160;Server</h3>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Ensure that you have synchronized Satellite&#160;Server repositories for Satellite, Capsule, and Satellite Client 6.</p>
</li>
<li>
<p>Ensure each external Capsule and Content Host can be updated by promoting the updated repositories to all relevant Content Views.</p>
</li>
</ul>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
If you customize configuration files, manually or using a tool such as Hiera, these changes are overwritten when the installation script runs during upgrading or updating.
You can use the <code>--noop</code> option with the satellite-installer script to test for changes.
For more information, see the Red Hat Knowledgebase solution <a href="https://access.redhat.com/solutions/3351311">How to use the noop option to check for changes in Satellite config files during an upgrade.</a>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>Updating Satellite&#160;Server to the Next Minor Version</strong></p>
</div>
<div class="olist arabic">
<div class="title">To Update Satellite&#160;Server:</div>
<ol class="arabic">
<li>
<p>Ensure the Satellite Maintenance repository is enabled:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># subscription-manager repos --enable \
satellite-maintenance-6.12-for-rhel-8-x86_64-rpms</pre>
</div>
</div>
</li>
<li>
<p>Check the available versions to confirm the next minor version is listed:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># satellite-maintain upgrade list-versions</pre>
</div>
</div>
</li>
<li>
<p>Use the health check option to determine if the system is ready for upgrade.
On first use of this command, <code>satellite-maintain</code> prompts you to enter the hammer admin user credentials and saves them in the <code>/etc/foreman-maintain/foreman-maintain-hammer.yml</code> file.</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># satellite-maintain upgrade check --target-version 6.12.<em>z</em></pre>
</div>
</div>
<div class="paragraph">
<p>Review the results and address any highlighted error conditions before performing the upgrade.</p>
</div>
</li>
<li>
<p>Because of the lengthy update time, use a utility such as <code>tmux</code> to suspend and reattach a communication session.
You can then check the upgrade progress without staying connected to the command shell continuously.</p>
<div class="paragraph">
<p>If you lose connection to the command shell where the upgrade command is running, you can see the logged messages in the <code>/var/log/foreman-installer/satellite.log</code> file to check if the process completed successfully.</p>
</div>
</li>
<li>
<p>Perform the upgrade:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># satellite-maintain upgrade run --target-version 6.12.<em>z</em></pre>
</div>
</div>
</li>
<li>
<p>Check when the kernel packages were last updated:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># rpm -qa --last | grep kernel</pre>
</div>
</div>
</li>
<li>
<p>Optional: If a kernel update occurred since the last reboot, stop Satellite services and reboot the system:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># satellite-maintain service stop
# reboot</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_updating_disconnected_satelliteserver"><a class="anchor" href="#_updating_disconnected_satelliteserver"></a>4.2. Updating Disconnected Satellite&#160;Server</h3>
<div class="paragraph">
<p>This section describes the steps needed to update in an Air-gapped Disconnected setup where the connected Satellite&#160;Server (which synchronizes content from CDN) is air gapped from a disconnected Satellite&#160;Server.</p>
</div>
<div class="paragraph">
<p>Complete the following steps on the connected Satellite&#160;Server.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Ensure that you have synchronized the following repositories in your connected Satellite&#160;Server.</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">rhel-8-for-x86_64-baseos-rpms
rhel-8-for-x86_64-appstream-rpms
satellite-6.12-for-rhel-8-x86_64-rpms
satellite-maintenance-6.12-for-rhel-8-x86_64-rpms</pre>
</div>
</div>
</li>
<li>
<p>Download the debug certificate of the organization and store it locally at, for example, <code>/etc/pki/katello/certs/org-debug-cert.pem</code> or a location of your choosing.
For more information, see <a href="https://access.redhat.com/documentation/en-us/red_hat_satellite/6.12/html-single/administering_red_hat_satellite/index#Creating_an_Organization_Debug_Certificate_admin">Creating an Organization Debug Certificate</a> in <em>Administering Red&#160;Hat Satellite</em>.</p>
</li>
<li>
<p>Create a Yum configuration file under <code>/etc/yum.repos.d</code> with the following repository information:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">[rhel-8-for-x86_64-baseos-rpms]
name=Red Hat Enterprise Linux 8 for x86_64 - BaseOS (RPMs)
baseurl=https://satellite.example.com/pulp/content/My_Organization/Library/content/dist/rhel8/8/x86_64/baseos/os
enabled=1
sslclientcert = /etc/pki/katello/certs/org-debug-cert.pem
sslclientkey = /etc/pki/katello/certs/org-debug-cert.pem
sslcacert = /etc/pki/katello/certs/katello-server-ca.crt
sslverify = 1

[rhel-8-for-x86_64-appstream-rpms]
name=Red Hat Enterprise Linux 8 for x86_64 - AppStream (RPMs)
baseurl=https://satellite.example.com/pulp/content/My_Organization/Library/content/dist/rhel8/8/x86_64/appstream/os
enabled=1
sslclientcert = /etc/pki/katello/certs/org-debug-cert.pem
sslclientkey = /etc/pki/katello/certs/org-debug-cert.pem
sslcacert = /etc/pki/katello/certs/katello-server-ca.crt
sslverify = 1

[satellite-6.12-for-rhel-8-x86_64-rpms]
name=Red&#160;Hat Satellite 6.12 for RHEL 8 RPMs x86_64
baseurl=https://satellite.example.com/pulp/content/My_Organization/Library/content/dist/layered/rhel8/x86_64/satellite/6.12/os
enabled=1
sslclientcert = /etc/pki/katello/certs/org-debug-cert.pem
sslclientkey = /etc/pki/katello/certs/org-debug-cert.pem
sslcacert = /etc/pki/katello/certs/katello-server-ca.crt

[satellite-maintenance-6.12-for-rhel-8-x86_64-rpms]
name=Red&#160;Hat Satellite Maintenance 6.12 for RHEL 8 RPMs x86_64
baseurl=https://satellite.example.com/pulp/content/My_Organization/Library/content/dist/layered/rhel8/x86_64/sat-maintenance/6.12/os
enabled=1
sslclientcert = /etc/pki/katello/certs/org-debug-cert.pem
sslclientkey = /etc/pki/katello/certs/org-debug-cert.pem
sslcacert = /etc/pki/katello/certs/katello-server-ca.crt
sslverify = 1</pre>
</div>
</div>
</li>
<li>
<p>In the configuration file, replace <code>/etc/pki/katello/certs/org-debug-cert.pem</code> in <code>sslclientcert</code> and <code>sslclientkey</code> with the location of the downloaded organization debug certificate.</p>
</li>
<li>
<p>Update <code>satellite.example.com</code> with correct FQDN for your deployment.</p>
</li>
<li>
<p>Replace <code>My_Organization</code> with the correct organization label in the <code>baseurl</code>.
To obtain the organization label, enter the command:</p>
<div class="listingblock">
<div class="content">
<pre># hammer organization list</pre>
</div>
</div>
</li>
<li>
<p>Enter the <code>reposync</code> command:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># reposync --delete --download-metadata -p ~/Satellite-repos -n \
 --disableplugin=foreman-protector \
 --repoid rhel-8-for-x86_64-baseos-rpms \
 --repoid rhel-8-for-x86_64-appstream-rpms \
 --repoid satellite-6.12-for-rhel-8-x86_64-rpms \
 --repoid satellite-maintenance-6.12-for-rhel-8-x86_64-rpms</pre>
</div>
</div>
<div class="paragraph">
<p>This downloads the contents of the repositories from the connected Satellite&#160;Server and stores them in the directory <code>~/Satellite-repos</code>.</p>
</div>
</li>
<li>
<p>Verify that the RPMs have been downloaded and the repository data directory is generated in each of the sub-directories of <code>~/Satellite-repos</code>.</p>
</li>
<li>
<p>Archive the contents of the directory</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># cd ~
# tar czf Satellite-repos.tgz Satellite-repos</pre>
</div>
</div>
</li>
<li>
<p>Use the generated <code>Satellite-repos.tgz</code> file to upgrade in the disconnected Satellite&#160;Server.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Perform the following steps on the disconnected Satellite&#160;Server:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Copy the generated <code>Satellite-repos.tgz</code> file to your disconnected Satellite&#160;Server</p>
</li>
<li>
<p>Extract the archive to anywhere accessible by the <code>root</code> user.
In the following example <code>/root</code> is the extraction location.</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># cd /root
# tar zxf Satellite-repos.tgz</pre>
</div>
</div>
</li>
<li>
<p>Create a Yum configuration file under <code>/etc/yum.repos.d</code> with the following repository information:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">[rhel-8-for-x86_64-baseos-rpms]
name=Red Hat Enterprise Linux 8 for x86_64 - BaseOS (RPMs)
baseurl=file:///root/Satellite-repos/rhel-8-for-x86_64-baseos-rpms
enabled=1

[rhel-8-for-x86_64-appstream-rpms]
name=Red Hat Enterprise Linux 8 for x86_64 - AppStream (RPMs)
baseurl=file:///root/Satellite-repos/rhel-8-for-x86_64-appstream-rpms
enabled=1

[satellite-6.12-for-rhel-8-x86_64-rpms]
name=Red&#160;Hat Satellite&#160;6 for RHEL 8 Server RPMs x86_64
baseurl=file:///root/Satellite-repos/satellite-6.12-for-rhel-8-x86_64-rpms
enabled=1

[satellite-maintenance-6.12-for-rhel-8-x86_64-rpms]
name=Red&#160;Hat Satellite Maintenance 6 for RHEL 8 Server RPMs x86_64
baseurl=file:///root/Satellite-repos/satellite-maintenance-6.12-for-rhel-8-x86_64-rpms
enabled=1</pre>
</div>
</div>
</li>
<li>
<p>In the configuration file, replace the <code>/root/Satellite-repos</code> with the extracted location.</p>
</li>
<li>
<p>Check the available versions to confirm the next minor version is listed:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># satellite-maintain upgrade list-versions</pre>
</div>
</div>
</li>
<li>
<p>Use the health check option to determine if the system is ready for upgrade.
On first use of this command, <code>satellite-maintain</code> prompts you to enter the hammer admin user credentials and saves them in the <code>/etc/foreman-maintain/foreman-maintain-hammer.yml</code> file.</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># satellite-maintain upgrade check --whitelist="check-upstream-repository,repositories-validate" --target-version 6.12.<em>z</em></pre>
</div>
</div>
</li>
<li>
<p>Review the results and address any highlighted error conditions before performing the upgrade.</p>
</li>
<li>
<p>Because of the lengthy update time, use a utility such as <code>tmux</code> to suspend and reattach a communication session.
You can then check the upgrade progress without staying connected to the command shell continuously.</p>
<div class="paragraph">
<p>If you lose connection to the command shell where the upgrade command is running, you can see the logged messages in the <code>/var/log/foreman-installer/satellite.log</code> file to check if the process completed successfully.</p>
</div>
</li>
<li>
<p>Perform the upgrade:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># satellite-maintain upgrade run --whitelist="check-upstream-repository,repositories-validate" --target-version 6.12.<em>z</em></pre>
</div>
</div>
</li>
<li>
<p>Check when the kernel packages were last updated:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># rpm -qa --last | grep kernel</pre>
</div>
</div>
</li>
<li>
<p>Optional: If a kernel update occurred since the last reboot, stop Satellite services and reboot the system:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># satellite-maintain service stop
# reboot</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="updating_capsule_server_to_next_minor_version"><a class="anchor" href="#updating_capsule_server_to_next_minor_version"></a>4.3. Updating Capsule&#160;Server</h3>
<div class="paragraph">
<p>Use this procedure to update Capsule&#160;Servers to the next minor version.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Ensure that the Satellite Maintenance repository is enabled:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># subscription-manager repos --enable \
satellite-maintenance-6.12-for-rhel-8-x86_64-rpms</pre>
</div>
</div>
</li>
<li>
<p>Check the available versions to confirm the next minor version is listed:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># satellite-maintain upgrade list-versions</pre>
</div>
</div>
</li>
<li>
<p>Use the health check option to determine if the system is ready for upgrade:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># satellite-maintain upgrade check --target-version 6.12.<em>z</em></pre>
</div>
</div>
<div class="paragraph">
<p>Review the results and address any highlighted error conditions before performing the upgrade.</p>
</div>
</li>
<li>
<p>Because of the lengthy update time, use a utility such as <code>tmux</code> to suspend and reattach a communication session.
You can then check the upgrade progress without staying connected to the command shell continuously.</p>
<div class="paragraph">
<p>If you lose connection to the command shell where the upgrade command is running, you can see the logged messages in the <code>/var/log/foreman-installer/capsule.log</code> file to check if the process completed successfully.</p>
</div>
</li>
<li>
<p>Perform the upgrade:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># satellite-maintain upgrade run --target-version 6.12.<em>z</em></pre>
</div>
</div>
</li>
<li>
<p>Check when the kernel packages were last updated:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># rpm -qa --last | grep kernel</pre>
</div>
</div>
</li>
<li>
<p>Optional: If a kernel update occurred since the last reboot, stop Satellite services and reboot the system:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># satellite-maintain service stop
# reboot</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated Sep 2023
</div>
</div>
</body>
</html>